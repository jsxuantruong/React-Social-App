(this["webpackJsonpreact-social"]=this["webpackJsonpreact-social"]||[]).push([[0],{314:function(e,t,n){},343:function(e,t,n){},345:function(e,t,n){},392:function(e,t){},394:function(e,t){},404:function(e,t){},406:function(e,t){},432:function(e,t){},434:function(e,t){},435:function(e,t){},440:function(e,t){},442:function(e,t){},448:function(e,t){},450:function(e,t){},469:function(e,t){},481:function(e,t){},484:function(e,t){},605:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=605},608:function(e,t){},610:function(e,t){},625:function(e,t,n){},626:function(e,t,n){},642:function(e,t,n){},643:function(e,t,n){},644:function(e,t,n){},645:function(e,t,n){},646:function(e,t,n){},647:function(e,t,n){},648:function(e,t,n){},649:function(e,t,n){},650:function(e,t,n){},651:function(e,t,n){},652:function(e,t,n){},653:function(e,t,n){},654:function(e,t,n){},655:function(e,t,n){},656:function(e,t,n){},657:function(e,t,n){},658:function(e,t,n){},660:function(e,t,n){},661:function(e,t,n){},662:function(e,t,n){},663:function(e,t,n){},664:function(e,t,n){},665:function(e,t,n){},666:function(e,t,n){},667:function(e,t,n){},668:function(e,t,n){},669:function(e,t,n){},670:function(e,t,n){},671:function(e,t,n){},672:function(e,t,n){},675:function(e,t,n){},676:function(e,t,n){},677:function(e,t,n){},678:function(e,t,n){},679:function(e,t,n){},680:function(e,t,n){},681:function(e,t,n){},696:function(e,t,n){},697:function(e,t,n){},698:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(29),i=n.n(a),s=n(4),o=n(21),l=n(9),u=(n(339),n(325)),d=n(11),j=n(328),b=n(2),f=n(3),v=n(6),O=n(5),m="access_token",p="refresh_token",h="https://codernoob-be.onrender.com/",x=h+"images/",g="https://codernoob-sv-socket.onrender.com",N=n(734),y=function(e,t){e.split(" ").forEach((function(e){t.classList.add(e)}))},_=function(e,t,n){n.classList.contains(e)?n.classList.replace(e,t):n.classList.replace(t,e)},C=function(e){var t={video:e,audio:!0};return navigator.mediaDevices.getUserMedia(t)},k=function(e){return Array.from(document.querySelectorAll(".video")).find((function(t){return t.getAttribute("streamId")===e}))},I=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&!k(e.id)){var n=document.createElement("div"),c=document.createElement("img");c.style.display="none",n.setAttribute("streamId",null===e||void 0===e?void 0:e.id);var r=document.createElement("i");y("fa-solid fa-thumbtack icon_video",r),n.classList.add("video"),t&&n.classList.add("you_video");var a=document.createElement("video");a.srcObject=e,a.addEventListener("loadedmetadata",(function(){a.play()})),r.onclick=function(e){var t=document.querySelector(".video.pin");if(r.classList.contains("fa-thumbtack")){if(t){t.classList.remove("pin");var c=t.querySelector(".icon_video");_("fa-thumbtack","fa-circle-xmark",c)}n.classList.add("pin")}else n.classList.remove("pin");_("fa-thumbtack","fa-circle-xmark",e.target)},n.append(a),n.append(c),n.append(r),document.querySelector(".video-joins").append(n)}},w=function(e){var t=e.img,n=e.streamId,c=k(n);if(c){var r=c.querySelector("video"),a=c.querySelector("img");r&&a&&(t?(r.style.display="none",r.pause(),a.src=t,a.style.display="block"):(r.style.display="block",r.play(),a.src="",a.style.display="none"))}},E="LOGIN_SUCCESS",A="LOGIN_FAILED",S="LOADING_START",R="LOADING_END",T="UPDATE_USER",F="UN_FOLLOW",L="FOLLOW",P="UPDATE_BACKGROUND_USER",D="UPDATE_AVATAR_USER",U="ADD_FRIEND",M="REMOVE_FRIEND",q="USER_LOGOUT",B="SET_CALL",V="END_CALL",Q="SET_IS_ANSWER",G="SET_FRIEND_INVITES",H="REFUSE_INVITE",J="SET_ACCEPT_INVITE",K="SET_USER_STREAM",Y="SET_IS_COMPLETE",W="UPDATE_CONVERSATION",Z="UPDATE_LAST_MESSAGE",z="UPDATE_STATUS_CONVERSATION",X="SET_STATUS_CONVERSATION",$="SET_CHAT",ee="SET_LIST_CONVERSATION",te="SET_CONVERSATION_CHAT",ne="SET_IS_SHOW",ce="UPDATE_CONVERSATION_DISPLAYS",re="UPDATE_FRIEND_CHAT",ae="ADD_CONVERSATION",ie="SET_NUMBER_UNREAD",se="INCREASE_NUMBER_UNREAD",oe="DECREASE_NUMBER_UNREAD",le="UPDATE_READ_CONVERSATION",ue="SET_NEW_CONVERSATION_CHAT",de="UPDATE_ID_COMMENT",je="SET_CREATE_ROOM",be="ADD_FRIEND_TO_ROOM",fe="REMOVE_FRIEND_TO_ROOM",ve="SET_LIST_FRIEND",Oe="RESET_CREATE_ROOM",me="SET_TYPE",pe="SET_LIST_FRIEND_REQUEST",he="ADD_LIST_FRIEND_REQUEST",xe="REMOVE_FRIEND_REQUEST",ge="INCREASE_NUMBER_FRIEND_REQUEST",Ne="SET_NUMBER_FRIEND_REQUEST",ye="SET_ELEMENT_CLICK",_e="SET_FILES",Ce="ADD_FILE",ke="REMOVE_FILE",Ie="SET_SOCKET",we="SET_USERS_ONLINE",Ee="ADD_USER_ONLINE",Ae="REMOVE_USER_OFFLINE",Se="RESET_NETWORK",Re="SET_LIST_NOTIFICATION",Te="ADD_NOTIFICATION",Fe="SET_NUMBER_NOTIFICATION_UNREAD",Le="INCREASE_NUMBER_NOTIFICATION_UNREAD",Pe="DECREASE_NUMBER_NOTIFICATION_UNREAD",De="SET_SHOW_NOTIFICATION",Ue="REMOVE_NOTIFICATION",Me="SET_TYPE_NOTIFICATION",qe="SET_NOTIFICATIONs_DISPLAY",Be="REMOVE_ALL_NOTIFICATION",Ve="UPDATE_LIST_CONVERSATION",Qe="ADD_NOTIFICATION_DISPLAY",Ge="SET_SHOW_NOTIFICATION_MENU",He="SET_PEER",Je="UPDATE_INFO_GET_POST",Ke="LOADING_POST_END",Ye="SET_STATUS_FRIEND",We="SET_USER_PROFILE",Ze="SET_IS_ME",ze=n(48),Xe=function(e,t){var n=Object(ze.a)(e).replace("seconds","gi\xe2y"),c=(n=(n=(n=n.replace("minutes","ph\xfat")).replace("hours","gi\u1edd")).replace("days","ng\xe0y")).indexOf(" ago");return t?n.slice(0,c):n},$e=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(c.useMemo)((function(){if(null!==e&&void 0!==e&&e.lastLogin)return Xe(e.lastLogin,t)}),[e])},et=(n(343),n(0)),tt=function(e){var t=e.isOnline,n=e.time,c=e.padding;return Object(et.jsx)("span",{className:"active ".concat(t?"online":"offline"),style:{padding:c},children:!t&&n})},nt=(n(345),n(63)),ct=n.n(nt),rt=n(194);n(311).config(),rt.config({cloud_name:"ko-c",api_key:"859769854664576",api_secret:"4IajgOMmiGtm4j3D-kz7AhqyiCw"});var at=rt;n(311).config();var it=function(){var e=Object(v.a)(Object(f.a)().mark((function e(t){var n;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(t.map((function(e){var t=new FormData;return e.camera?t.append("file",e.url):t.append("file",e),t.append("upload_preset","react-social"),ct.a.post("https://api.cloudinary.com/v1_1/ko-c/image/upload",t)})));case 3:return n=e.sent,e.abrupt("return",n.map((function(e){var t=e.data;return{url:t.url,public_id:t.public_id}})));case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),st=function(e){try{e.map((function(e){return at.uploader.destroy(e,(function(e,t){if(t)throw t}))}))}catch(t){throw t}},ot=function(e,t){var n=Object(c.useState)(!1),r=Object(O.a)(n,2),a=r[0],i=r[1],o=Object(s.c)((function(e){return e.network})).usersOnline,l=Object(s.c)((function(e){return e.auth})).userCurrent;return Object(c.useEffect)((function(){return(null===l||void 0===l?void 0:l._id)===(null===e||void 0===e?void 0:e._id)?i(!0):o&&o.length>0?i(o.includes(null===e||void 0===e?void 0:e._id)):void i(!1)}),[o,e,l]),[a,i]},lt=function(e){var t=e.isStatus,n=void 0===t||t,r=e.user,a=e.width,i=e.height,l=e.link,u=void 0===l||l,d=e.isShowOffline,j=void 0===d||d,b=e.className,f=void 0===b?"":b,v=Object(c.useState)(),m=Object(O.a)(v,2),p=m[0],h=m[1],g=ot(r),N=Object(O.a)(g,2),y=N[0],_=(N[1],Object(s.c)((function(e){return e.auth})).userCurrent);Object(c.useEffect)((function(){_&&r&&h(_._id===r._id||_.friends.includes(r._id))}),[r,_]);var C=$e(r),k=Object(c.useMemo)((function(){return function(e){var t;return(null===e||void 0===e||null===(t=e.profilePicture)||void 0===t?void 0:t.length)&&(null===e||void 0===e?void 0:e.profilePicture[0])||x+"no-avatar.png"}(r)}),[r]);return Object(et.jsx)(et.Fragment,{children:u?Object(et.jsxs)(o.b,{to:"/profile/".concat(null===r||void 0===r?void 0:r._id),style:{width:a,height:i},className:"avatarContainer ".concat(f),children:[Object(et.jsx)("img",{className:"avatarImg",src:k,alt:""}),p&&n?j?C&&Object(et.jsx)(tt,{isOnline:y,time:C}):y&&C&&Object(et.jsx)(tt,{isOnline:y,time:C}):Object(et.jsx)(et.Fragment,{})]}):Object(et.jsxs)("div",{className:"avatarContainer ".concat(f),style:{width:a,height:i},children:[Object(et.jsx)("img",{className:"avatarImg",src:k,alt:""}),p&&n?j?C&&Object(et.jsx)(tt,{isOnline:y,time:C}):y&&C&&Object(et.jsx)(tt,{isOnline:y,time:C}):Object(et.jsx)(et.Fragment,{})]})})},ut=function(){var e=Object(s.c)((function(e){return e.network})).socket,t=Object(s.c)((function(e){return e.call})),n=t.isVideo,c=t.userSendCall,r=t.isSenderCall,a=t.isAnswer,i=t.roomCallId,o=t.conversationId,l=Object(s.c)((function(e){return e.peer})),u=Object(s.c)((function(e){return e.auth})).userCurrent,d=Object(s.b)(),j=function(){var t=Object(v.a)(Object(f.a)().mark((function t(){var r;return Object(f.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return d({type:Q,payload:!0}),t.prev=1,t.next=4,C(n);case 4:if(r=t.sent,d({type:K,payload:r}),I(r,!0),e){t.next=9;break}return t.abrupt("return");case 9:e.emit("joinRoomCall",{userSendCall:null===c||void 0===c?void 0:c._id,userReceiveCall:null===u||void 0===u?void 0:u._id,roomCallId:i,peerId:l._id,isCreate:!0,conversationId:o,isVideo:n,userName:null===u||void 0===u?void 0:u.userName,streamId:r.id}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),console.log("err",{err:t.t0});case 15:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(){return t.apply(this,arguments)}}();return Object(et.jsxs)("div",{className:"call_box",children:[Object(et.jsxs)("div",{className:"text-center call_info",style:{padding:"40px 0"},children:[Object(et.jsx)(lt,{width:"150px",height:"150px",user:c,link:!1,isStatus:!1}),Object(et.jsx)("h4",{children:null===c||void 0===c?void 0:c.userName})]}),!a&&Object(et.jsx)("div",{children:n?Object(et.jsx)("span",{children:"calling video..."}):Object(et.jsx)("span",{children:"calling audio..."})}),Object(et.jsxs)("div",{className:"call_menu",children:[Object(et.jsx)("i",{className:"fa-solid fa-phone-slash text-danger",onClick:function(){e.emit("userRefuseCall",{userRefuseId:null===u||void 0===u?void 0:u._id,receiverId:null===c||void 0===c?void 0:c._id,isCreate:!0}),d({type:V})}}),!r&&!a&&Object(et.jsx)("i",{className:"fa-solid fa-phone-flip",onClick:j})]})]})},dt=(n(625),n(626),function(e){var t=e.mess;return Object(et.jsx)("div",{className:"mess-pretty",children:t})}),jt=function(){var e=Object(s.c)((function(e){return e.call})).userSendCall,t=Object(c.useState)(20),n=Object(O.a)(t,2),r=n[0],a=n[1],i=Object(s.c)((function(e){return e.auth})).userCurrent,o=Object(s.c)((function(e){return e.network})).socket,l=Object(s.c)((function(e){return e.peer})),u=Object(s.c)((function(e){return e.call})),d=u.isAnswer,j=u.roomCallId,b=u.isVideo,m=u.conversationId,p=Object(s.b)();Object(c.useEffect)((function(){if(!d){if(!r)return x();var e=function(){return a((function(e){return e-1}))},t=setTimeout(e,1e3);return function(){return clearTimeout(t,e)}}}),[r,d]);var h=function(){var t=Object(v.a)(Object(f.a)().mark((function t(){var n;return Object(f.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p({type:Q,payload:!0}),t.next=3,C(b);case 3:if(n=t.sent,p({type:K,payload:n}),I(n,!0),o){t.next=8;break}return t.abrupt("return");case 8:o.emit("joinRoomCall",{userSendCall:null===e||void 0===e?void 0:e._id,userReceiveCall:null===i||void 0===i?void 0:i._id,roomCallId:j,peerId:l._id,isCreate:!1,conversationId:m,userName:null===i||void 0===i?void 0:i.userName,streamId:n.id});case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),x=function(){p({type:H}),null===o||void 0===o||o.emit("refuseInviteCall",null===i||void 0===i?void 0:i._id)};return Object(et.jsxs)("div",{className:"modalInvite_content",children:[Object(et.jsx)("span",{className:"close",onClick:x,children:"\xd7"}),Object(et.jsxs)("div",{className:"info",children:[Object(et.jsx)(lt,{user:e,link:!1,isStatus:!1}),Object(et.jsx)(dt,{mess:"".concat(null===e||void 0===e?void 0:e.userName," Invited you to join the call")})]}),Object(et.jsxs)("div",{className:"buttons",children:[Object(et.jsx)("button",{type:"button",className:"btn btn-danger",onClick:x,children:"Cancel"}),Object(et.jsx)("button",{type:"button",className:"btn btn-primary",onClick:h,children:"Join ".concat(r)})]})]})},bt=n(7),ft=n(127),vt=n.n(ft),Ot=n(128),mt=ct.a.create({baseURL:h+"v1/api"}),pt=function(e){if(!e)return!0;var t=new Date;return Object(Ot.a)(e).exp<t.getTime()/1e3},ht=function(e){return localStorage.getItem(e)?JSON.parse(localStorage.getItem(e)):""},xt=null,gt=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t,n;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=ht(p),!pt(t)){e.next=4;break}throw new Error("Refresh token invalid");case 4:return e.next=6,ct.a.post("/auth/refresh-token",{refreshToken:t});case 6:return n=e.sent,e.abrupt("return",n);case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();mt.interceptors.request.use(function(){var e=Object(v.a)(Object(f.a)().mark((function e(t){var n,c,r;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=ht(m)){e.next=3;break}throw new Error("Please login");case 3:if(!pt()){e.next=17;break}return e.prev=4,xt=xt||gt(),e.next=8,xt;case 8:c=e.sent,r=c.data.newAccessToken,localStorage.setItem(m,JSON.stringify(r)),n=r,e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(4),new Error("Refresh Token failed");case 17:return t.headers.Authorization="Bearer "+n,e.abrupt("return",t);case 19:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t){return e.apply(this,arguments)}}(),(function(e){return Promise.reject(e)})),mt.interceptors.response.use((function(e){return e.data}),(function(e){var t,n;console.log("error on respon",e);var c=(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||e.message;return l.b.error(c,{autoClose:1e3}),Promise.reject(c)}));var Nt=mt,yt=function(){var e=Object(v.a)(Object(f.a)().mark((function e(t){var n;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Nt.get("".concat(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_t=function(){var e=Object(v.a)(Object(f.a)().mark((function e(t,n){var c;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Nt.post("".concat(t),n);case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ct=function(){var e=Object(v.a)(Object(f.a)().mark((function e(t,n){var c;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Nt.put("".concat(t),n);case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),kt=function(){var e=Object(v.a)(Object(f.a)().mark((function e(t,n){var c;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Nt.patch("".concat(t),n);case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),It=function(){var e=Object(v.a)(Object(f.a)().mark((function e(t){var n;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Nt.delete("".concat(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),wt=function(e){var t=e.friend,n=Object(c.useState)(!1),r=Object(O.a)(n,2),a=r[0],i=r[1],o=Object(s.c)((function(e){return e.auth})).userCurrent,u=Object(s.c)((function(e){return e.network})).socket,d=Object(s.c)((function(e){return e.call})),j=d.isVideo,b=d.roomCallId,f=d.conversationId,v=Object(c.useRef)();Object(c.useEffect)((function(){if(a&&!v.current){var e=new Date;v.current=3e5+e.getTime();var t=setTimeout((function(){i(!1),v.current=""}),1e3);return function(){return clearTimeout(t)}}}),[a]);return Object(et.jsxs)(et.Fragment,{children:[Object(et.jsx)(lt,{width:"60px",height:"60px",user:t,link:!1,isShowOffline:!1}),Object(et.jsx)("p",{children:null===t||void 0===t?void 0:t.userName}),Object(et.jsx)("button",{type:"button",className:"btn btn-info",onClick:function(e){if(a)return l.b.info("Already invited this friend ".concat(Object(ze.a)(v.current)," later can invite again"),{autoClose:1e3});u&&o&&(u.emit("createCall",{isVideo:j,sender:{profilePicture:o.profilePicture,userName:o.userName,_id:null===o||void 0===o?void 0:o._id},receiverId:null===t||void 0===t?void 0:t._id,roomCallId:b,isCreate:!1,conversationId:f}),i(!0))},children:a?"Invited":"Invite"})]})},Et=(n(642),function(){var e=Object(s.c)((function(e){return e.call})),t=e.userCall,n=e.isAnswer,r=e.fristLoadFriends,a=e.friendInvites,i=Object(s.c)((function(e){return e.auth})).userCurrent,o=Object(s.b)();Object(c.useEffect)((function(){var e=!0,n=function(){var n=Object(v.a)(Object(f.a)().mark((function n(){var c,r,a;return Object(f.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!i||!i._id){n.next=14;break}return n.prev=1,n.next=4,yt("/user/get-friends/".concat(null===i||void 0===i?void 0:i._id));case 4:c=n.sent,c.message,r=c.friends,a=Object(bt.a)(r),t&&(a=r.filter((function(e){return(null===e||void 0===e?void 0:e._id)!==t._id}))),e&&o({type:G,payload:a}),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(1),console.log("err",n.t0);case 14:case"end":return n.stop()}}),n,null,[[1,11]])})));return function(){return n.apply(this,arguments)}}();return r&&n(),function(){return e=!1}}),[i,n]);var l=Object(c.useMemo)((function(){return{dots:!0,infinite:!0,speed:500,slidesToShow:3,slidesToScroll:1}})),u=function(e){return a.map((function(t){return Object(et.jsx)("div",{children:Object(et.jsx)("div",{className:"friend_invite "+e,children:Object(et.jsx)(wt,{friend:t})})},null===t||void 0===t?void 0:t._id)}))};return Object(et.jsxs)("div",{className:"invite",children:[Object(et.jsx)("p",{className:"title",children:"Invite More People"}),a.length<=3?Object(et.jsx)("div",{className:"invite_content",children:u("no-slider")}):Object(et.jsx)(vt.a,Object(b.a)(Object(b.a)({},l),{},{children:u()}))]})}),At=(n(643),function(){return Object(et.jsxs)("nav",{children:[Object(et.jsx)("img",{src:x+"logo.png",alt:""}),Object(et.jsxs)("ul",{children:[Object(et.jsx)("li",{children:Object(et.jsx)("img",{src:x+"live.png",alt:"",className:"icon_modal-active"})}),Object(et.jsx)("li",{children:Object(et.jsx)("img",{src:x+"video.png",alt:""})}),Object(et.jsx)("li",{children:Object(et.jsx)("img",{src:x+"message.png",alt:""})}),Object(et.jsx)("li",{children:Object(et.jsx)("img",{src:x+"notification.png",alt:""})}),Object(et.jsx)("li",{children:Object(et.jsx)("img",{src:x+"users.png",alt:""})}),Object(et.jsx)("li",{children:Object(et.jsx)("img",{src:x+"setting.png",alt:""})})]})]})}),St=function(){var e=Object(c.useState)(0),t=Object(O.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(0),i=Object(O.a)(a,2),o=i[0],u=i[1],d=Object(c.useState)(0),j=Object(O.a)(d,2),m=j[0],p=j[1],h=Object(c.useState)(0),g=Object(O.a)(h,2),N=g[0],y=g[1],_=Object(c.useState)(!0),E=Object(O.a)(_,2),A=E[0],S=E[1],R=Object(c.useState)(!0),T=Object(O.a)(R,2),F=T[0],L=T[1],P=Object(s.c)((function(e){return e.call})),D=P.isVideo,U=P.userReciverCall,M=P.isAnswer,q=P.isCreate,B=P.roomCallId,G=P.isSenderCall,H=P.userStream,J=P.conversationId,Y=Object(s.c)((function(e){return e.network})).socket,W=Object(s.c)((function(e){return e.peer})),Z=Object(s.c)((function(e){return e.auth})).userCurrent,z=Object(s.b)();Object(c.useEffect)((function(){p(N%60),u(parseInt(N/60)),r(parseInt(N/3600))}),[N]),Object(c.useEffect)((function(){if(W&&H)return W.on("call",(function(e){e.answer(H),e.on("stream",(function(e){I(e)}))})),function(){return W.removeListener("call")}}),[H,W]),Object(c.useEffect)((function(){var e=setInterval((function(){return y((function(e){return e+1}))}),1e3);return function(){y(0),clearInterval(e)}}),[]),Object(c.useEffect)((function(){var e=function(){var e=Object(v.a)(Object(f.a)().mark((function e(t){var n,c,r,a;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.peerId,c=t.userName,l.b.info("".concat(c," joined the call"),{autoClose:1e3}),H){e.next=9;break}return e.next=5,C(D);case 5:r=e.sent,z({type:K,payload:r}),e.next=10;break;case 9:r=H;case 10:if(a=W.call(n,r),M||(z({type:Q,payload:!0}),I(r,!0)),a){e.next=14;break}return e.abrupt("return");case 14:a.on("stream",(function(e){I(e)}));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Y.on("user-joined-call",e),function(){return null===Y||void 0===Y?void 0:Y.off("user-joined-call",e)}}),[Y,H,M]),Object(c.useEffect)((function(){var e=function(e){var t=e.streamId,n=e.userName;l.b.info("".concat(n," got off the call"),{autoClose:1e3});var c=k(t);c&&c.remove()};return Y.on("user-call-out",e),function(){return null===Y||void 0===Y?void 0:Y.off("user-call-out",e)}}),[Y]),Object(c.useEffect)((function(){if(Y){var e=function(e,t){l.b.info(e,{autoClose:500}),t&&z({type:V})};return Y.on("callRefused",(function(){e("".concat(null===U||void 0===U?void 0:U.userName," refuse the call"))})),Y.on("userCallBusy",(function(t){e("".concat(U.userName," is on another call!"),t)})),function(){null===Y||void 0===Y||Y.off("userCallBusy"),null===Y||void 0===Y||Y.off("callRefused")}}}),[Y,U]),Object(c.useEffect)((function(){if(Y)return Y.on("update-user-camera",w),function(){return null===Y||void 0===Y?void 0:Y.off("update-user-camera",w)}}),[Y]),Object(c.useEffect)((function(){if(!M){var e=setTimeout((function(){G&&(null===Y||void 0===Y||Y.emit("userCallNoReaction",{userCallId:U._id,userSendCallId:Z._id,conversationId:J,isVideo:D})),z({type:V})}),1e4);return function(){return clearTimeout(e)}}y(0)}),[M]);var X=function(e){if(H){var t=H.getTracks().find((function(t){return t.kind===e}));if(t){var n={};t.enabled?("video"===e&&(n.img=null!==Z&&void 0!==Z&&Z.profilePicture.length?null===Z||void 0===Z?void 0:Z.profilePicture[0]:x+"no-avatar.png"),t.enabled=!1):t.enabled=!0,"video"===e&&(n.streamId=null===H||void 0===H?void 0:H.id,n.roomCallId=B,Y.emit("user-turn-off-video",Object(b.a)({},n)),w(n))}}};return Object(et.jsxs)("div",{className:"call_modal",children:[Object(et.jsx)("div",{className:"modal_container",style:{display:M?"none":"flex"},children:!M&&(q?Object(et.jsx)(ut,{}):Object(et.jsx)(jt,{}))}),Object(et.jsxs)("div",{className:"header",style:{display:"".concat(M?"block":"none")},children:[Object(et.jsx)(At,{}),Object(et.jsxs)("div",{className:"container",children:[Object(et.jsxs)("div",{className:"top-icons",children:[Object(et.jsx)("img",{src:x+"search.png",alt:""}),Object(et.jsx)("img",{src:x+"menu.png",alt:""})]}),Object(et.jsxs)("div",{className:"video_layout",children:[Object(et.jsxs)("div",{className:"content_left",children:[Object(et.jsx)("div",{className:"pin_video border_center"}),Object(et.jsxs)("div",{className:"time_video",children:[Object(et.jsx)("span",{children:n.toString().length<2?"0"+n:n}),Object(et.jsx)("span",{children:":"}),Object(et.jsx)("span",{children:o.toString().length<2?"0"+o:o}),Object(et.jsx)("span",{children:":"}),Object(et.jsx)("span",{children:m.toString().length<2?"0"+m:m})]}),Object(et.jsxs)("div",{className:"controls",children:[Object(et.jsx)("div",{className:"icon-control",children:Object(et.jsx)("img",{src:x+"chat.png",alt:""})}),Object(et.jsx)("div",{className:"icon-control",onClick:function(){X("video"),L((function(e){return!e}))},children:F?Object(et.jsx)("i",{className:"fa-solid fa-video-slash"}):Object(et.jsx)("i",{className:"fa-solid fa-video"})}),Object(et.jsx)("div",{className:"icon-control",children:Object(et.jsx)("img",{src:x+"call.png",alt:"",className:"call-icon",onClick:function(){var e=H.id;(null===H||void 0===H?void 0:H.getTracks()).forEach((function(e){return e.stop()})),z({type:V}),null===Y||void 0===Y||Y.emit("end-call",{userOutCallId:null===Z||void 0===Z?void 0:Z._id,streamId:e})}})}),Object(et.jsx)("div",{className:"icon-mic icon-control",onClick:function(){X("audio"),S((function(e){return!e}))},children:A?Object(et.jsx)("img",{src:x+"mic.png",alt:""}):Object(et.jsx)("i",{className:"fa-solid fa-microphone-slash"})}),Object(et.jsx)("div",{className:"icon-control",children:Object(et.jsx)("img",{src:x+"cast.png",alt:""})})]})]}),Object(et.jsxs)("div",{className:"content_right",children:[Object(et.jsxs)("div",{className:"joined",children:[Object(et.jsx)("p",{children:"People Joined"}),Object(et.jsx)("div",{className:"video-joins"})]}),Object(et.jsx)(Et,{})]})]})]})]})]})},Rt=n(713);ct.a.defaults.baseURL=h+"v1/api";var Tt=function(e,t){return function(){var n=Object(v.a)(Object(f.a)().mark((function n(c){var r,a,i,s,o,u,d,j,b;return Object(f.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c({type:S}),n.prev=1,n.next=4,ct.a.post("/auth/login",e);case 4:r=n.sent,a=r.data,i=a.user,s=a.message,o=a.accessToken,u=a.refreshToken,l.b.success(s,{autoClose:500}),c({type:E,payload:i}),localStorage.setItem(m,JSON.stringify(o)),localStorage.setItem(p,JSON.stringify(u)),t("/"),n.next=18;break;case 13:n.prev=13,n.t0=n.catch(1),b=n.t0.message||(null===n.t0||void 0===n.t0||null===(d=n.t0.response)||void 0===d||null===(j=d.data)||void 0===j?void 0:j.message),l.b.error(b,{autoClose:2e3}),c({type:A,payload:n.t0});case 18:case"end":return n.stop()}}),n,null,[[1,13]])})));return function(e){return n.apply(this,arguments)}}()},Ft=function(e,t){return function(){var n=Object(v.a)(Object(f.a)().mark((function n(c){var r,a,i;return Object(f.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,c({type:S}),n.next=4,ct.a.post("/auth/register",e);case 4:t("/login"),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(0),i=n.t0.message||(null===n.t0||void 0===n.t0||null===(r=n.t0.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message),l.b.error(i,{autoClose:2e3});case 11:return n.prev=11,c({type:R}),n.finish(11);case 14:case"end":return n.stop()}}),n,null,[[0,7,11,14]])})));return function(e){return n.apply(this,arguments)}}()};n(644);var Lt=n(13),Pt=n(715),Dt=n(714),Ut=(n(645),function(e){var t=e.image,n=e.file,c=e.setImages,r=e.setFiles;return Object(et.jsxs)(et.Fragment,{children:[Object(et.jsx)("img",{src:t||(n.camera?n.url:URL.createObjectURL(n))}),Object(et.jsx)("span",{className:"imgCancel",onClick:function(){return t?c((function(e){return e.filter((function(e){return e.url!==t}))})):r((function(e){return e.filter((function(e){return e.uuid!==n.uuid}))}))},children:Object(et.jsx)(Dt.a,{})})]})}),Mt=(n(646),function(e){var t=e.setIsTakePhoto,n=e.isTakePhoto,r=e.files,a=e.height,i=e.width,s=e.id,o=e.multiple,l=e.setFiles,u=Object(c.useRef)(),d=Object(c.useRef)(),j=Object(c.useState)(),b=Object(O.a)(j,2),m=b[0],p=b[1],h=Object(c.useState)(!0),x=Object(O.a)(h,2),g=x[0],y=x[1],_=Object(c.useState)(""),C=Object(O.a)(_,2),k=C[0],I=C[1],w=Object(c.useState)(!1),E=Object(O.a)(w,2),A=E[0],S=E[1],R=Object(c.useRef)({video:{width:{min:1280,ideal:1920,max:2560},height:{min:720,ideal:1080,max:1440}}}),T=function(){m&&m.getTracks().forEach((function(e){e.stop()}))},F=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T(),R.current.video.facingMode=g?"user":"environment",e.prev=2,e.next=5,navigator.mediaDevices.getUserMedia(R.current);case 5:t=e.sent,u.current.srcObject=t,u.current.play(),p(t),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),I("An error occurred while starting the camera");case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){var e;return n?!1 in navigator||!1 in navigator.mediaDevices?void I("Not support API camera"):(F(),function(){var e;null===u||void 0===u||null===(e=u.current)||void 0===e||e.srcObject.getTracks().forEach((function(e){e.stop()}))}):(null===u||void 0===u||null===(e=u.current)||void 0===e||e.pause(),T(),void p())}),[n,g]);return Object(et.jsxs)("div",{children:[Object(et.jsxs)("div",{className:"optionUploadImage",children:[Object(et.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(){return t(!1)},children:"Upload photos"}),Object(et.jsx)("button",{type:"button",className:"btn btn-info",onClick:function(){return t(!0)},children:"Take a photo"})]}),Object(et.jsxs)("div",{className:"uploadImageContent",children:[n?Object(et.jsxs)(et.Fragment,{children:[Object(et.jsxs)("div",{className:"takeVideoTop",children:[Object(et.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:function(){A?u.current.play():u.current.pause(),S((function(e){return!e}))},children:"".concat(A?"Play":"Stop"," video")}),Object(et.jsx)("button",{type:"button",className:"btn btn-warning",onClick:function(){d.current.width=u.current.videoWidth,d.current.height=u.current.videoHeight,d.current.getContext("2d").drawImage(u.current,0,0);var e=d.current.toDataURL("image/png");l(o?function(t){return[].concat(Object(bt.a)(t),[{camera:!0,url:e,uuid:Object(N.a)()}])}:[{camera:!0,url:e,uuid:Object(N.a)()}])},children:"Shot"}),Object(et.jsx)("button",{type:"button",className:"btn btn-dark",onClick:function(){y((function(e){return!e}))},children:"Change camera"})]}),Object(et.jsxs)("div",{className:"takeVideoBody",children:[k||Object(et.jsx)("video",{ref:u}),Object(et.jsx)("canvas",{style:{display:"none"},ref:d})]})]}):Object(et.jsxs)("div",{className:"uploadImageContentTop",children:[Object(et.jsxs)("label",{htmlFor:"file".concat(s),className:"shareOption",children:[Object(et.jsx)(Pt.a,{htmlColor:"tomato",className:"shareIcon"}),Object(et.jsx)("span",{className:"shareOptionText",children:"Choose photo"})]}),Object(et.jsx)("input",{multiple:o,style:{display:" none"},type:"file",id:"file".concat(s),accept:".png,.jpeg,.jpg",onChange:function(e){var t=Array.from(e.target.files).map((function(e){return e.uuid=Object(N.a)(),e}));l(o?function(e){return[].concat(Object(bt.a)(e),Object(bt.a)(t))}:Object(bt.a)(t))}})]}),Object(et.jsx)("div",{className:"uploadImageContentBody",children:Object(et.jsx)("div",{className:"shareImgContainer",children:r.map((function(e){return Object(et.jsx)("div",{className:"imgContainer",style:{width:i,height:a},children:Object(et.jsx)(Ut,{file:e,setFiles:l})},e.uuid)}))})})]})]})}),qt=function(e){var t=e.height,n=e.width,r=e.id,a=e.text,i=e.multiple,s=e.typeImage,o=e.onSave,l=Object(c.useState)([]),u=Object(O.a)(l,2),d=u[0],j=u[1],b=Object(c.useState)(!1),f=Object(O.a)(b,2),v=f[0],m=f[1];return Object(et.jsx)(et.Fragment,{children:Object(et.jsx)("div",{className:"modal fade",id:r,tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(et.jsx)("div",{className:"modal-dialog chooseImgage",role:"document",children:Object(et.jsxs)("div",{className:"modal-content",children:[Object(et.jsxs)("div",{className:"modal-header",children:[Object(et.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"".concat(a)}),Object(et.jsx)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:function(){m(!1)},children:Object(et.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(et.jsx)("div",{className:"modal-body",children:Object(et.jsx)(Mt,{setIsTakePhoto:m,isTakePhoto:v,files:d,height:t,width:n,setFiles:j,multiple:i,id:r})}),Object(et.jsxs)("div",{className:"modal-footer",children:[Object(et.jsx)("button",{type:"button",className:"btn btn-danger",onClick:function(){o(d,s),j([]),m(!1)},"data-dismiss":"modal",children:"Save"}),Object(et.jsx)("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal",onClick:function(){m(!1)},children:"Close"})]})]})})})})},Bt=n(716);n(647);function Vt(e){var t=e.conversation,n=t._id,r=t.reads,a=t.members,i=t.isMultiple,o=t.name,l=t.image,u=t.listMembers,d=t.images,j=t.nameConversation,b=Object(c.useState)(""),m=Object(O.a)(b,2),p=m[0],h=m[1],g=Object(c.useState)(!0),y=Object(O.a)(g,2),_=y[0],C=y[1],k=Object(c.useState)((function(){return t.lastMessage||""})),I=Object(O.a)(k,2),w=I[0],E=I[1],A=Object(s.c)((function(e){return e.auth})).userCurrent,S=Object(s.c)((function(e){return e.chat})),R=S.lastMessageConversation,T=(S.statusConversations,Object(s.b)());Object(c.useEffect)((function(){var e=!0;if(t){var n=function(){var n=Object(v.a)(Object(f.a)().mark((function n(){var c,r,i;return Object(f.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=a.filter((function(e){return e!==(null===A||void 0===A?void 0:A._id)})),n.next=3,Promise.all(c.map((function(e){return yt("/user?userId=".concat(e))})));case 3:r=n.sent,i=r.map((function(e){return e.user})),e&&T({type:W,payload:{conversationId:null===t||void 0===t?void 0:t._id,listMembers:i}});case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return u||n(),function(){return e=!1}}}),[t,u]),Object(c.useEffect)((function(){var e=!0;if(t&&A){var n=function(){var n=Object(v.a)(Object(f.a)().mark((function n(){return Object(f.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i&&l.length&&e&&T({type:W,payload:{conversationId:null===t||void 0===t?void 0:t._id,images:[{src:l[0],key:Object(N.a)()}]}});case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return d||n(),function(){return e=!1}}}),[t,A,d]),Object(c.useEffect)((function(){if(t&&A&&!j)if(i)T({type:W,payload:{conversationId:null===t||void 0===t?void 0:t._id,nameConversation:o}});else{if(!u)return;var e=u[0].userName;T({type:W,payload:{conversationId:null===t||void 0===t?void 0:t._id,nameConversation:e}})}}),[t,A,j,u,o]),Object(c.useEffect)((function(){r&&A&&C((function(){return r.includes(A._id)}))}),[r,A]),Object(c.useEffect)((function(){R&&(null===R||void 0===R?void 0:R.conversationId)===n&&E(R)}),[R]),Object(c.useEffect)((function(){if(u&&A&&!(d&&d.length>0)){var e=[];if(i){for(var n=[],c=a.length,r=0;r<2;++r){var s=void 0;do{var o=Math.floor(Math.random()*c);n.includes(a[o])||(n.push(a[o]),s=!0)}while(!s)}e=n.map((function(e){var t;return{src:(t=e===(null===A||void 0===A?void 0:A._id)?A.profilePicture:u.find((function(t){return(null===t||void 0===t?void 0:t._id)===e})).profilePicture)&&t.length?t[0]:x+"no-avatar.png",key:Object(N.a)()}}))}else{var l=u[0].profilePicture;e.push({src:l.length?l[0]:x+"no-avatar.png",key:Object(N.a)()})}T({type:W,payload:{conversationId:null===t||void 0===t?void 0:t._id,images:e}})}}),[u,a,d,A]),Object(c.useEffect)((function(){if(w&&u&&A){w.isNotify;var e,t=w.senderId,n=(w.notify,w.text);if(t===(null===A||void 0===A?void 0:A._id))e="You";else{var c=u.find((function(e){return(null===e||void 0===e?void 0:e._id)===t}));e=F(null===c||void 0===c?void 0:c.userName)}h(e+": "+n)}}),[w,u]);var F=function(e){var t=e.split(" "),n=t.length;return t&&n?t[n-1]:(null===e||void 0===e?void 0:e.userName)||""};return Object(et.jsxs)(et.Fragment,{children:[Object(et.jsx)("div",{className:"pic banner",children:d&&(1===d.length?Object(et.jsx)("img",{className:"one-img",src:d[0].src,alt:""}):Object(et.jsx)("div",{className:"multiple-img",children:d.map((function(e){return Object(et.jsx)("img",{src:e.src},e.key)}))}))}),Object(et.jsx)("div",{className:"name ".concat(_?"":"unread"),children:j}),Object(et.jsx)("div",{className:"message ".concat(_?"":"unread"),children:"notify"===(null===w||void 0===w?void 0:w[0])?null===w||void 0===w?void 0:w[1]:p}),!_&&Object(et.jsx)("div",{className:"NotificationCircle"})]})}n(648);var Qt=function(){var e=Object(c.useState)(),t=Object(O.a)(e,2),n=t[0],r=t[1],a=Object(c.useRef)(""),i=Object(c.useRef)(""),o=Object(s.c)((function(e){return e.auth})).userCurrent,u=Object(s.c)((function(e){return e.createRoomChat})),d=u.friends,j=u.friendAdds,b=Object(s.b)();Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(v.a)(Object(f.a)().mark((function t(){var n,c;return Object(f.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!o||!o._id){t.next=12;break}return t.prev=1,t.next=4,yt("/user/get-friends/".concat(null===o||void 0===o?void 0:o._id));case 4:n=t.sent,n.message,c=n.friends,e&&b({type:ve,payload:c}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("err",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){return e=!1}}),[o]);var m=function(){return b({type:Oe})},p=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t,c,r,s,u;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},a.current.value){e.next=3;break}return e.abrupt("return",l.b.info("Please enter name room chat",{autoClose:500}));case 3:if(j.length){e.next=5;break}return e.abrupt("return",l.b.info("Please add members to room chat",{autoClose:500}));case 5:if(t.members=[null===o||void 0===o?void 0:o._id].concat(Object(bt.a)(j.map((function(e){return null===e||void 0===e?void 0:e._id})))),!n){e.next=12;break}return e.next=9,it([n]);case 9:for(r in c=e.sent,t.image=[],c[0])t.image.push(c[0][r]);case 12:return t.name=a.current.value,t.desc=i.current.value,t.reads=[null===o||void 0===o?void 0:o._id].concat(Object(bt.a)(j.map((function(e){return null===e||void 0===e?void 0:e._id})))),t.status=[null===o||void 0===o?void 0:o._id],t.isMultiple=!0,e.next=19,_t("/conversation",t);case 19:s=e.sent,u=s.conversation,b({type:ae,payload:{conversation:u}}),m();case 23:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(et.jsx)("div",{className:"create_room_modal",children:Object(et.jsxs)("div",{className:"container",children:[Object(et.jsx)("h3",{className:"title",children:"Create New Room Chat"}),Object(et.jsxs)("div",{className:"content",children:[Object(et.jsxs)("div",{className:"content-left",children:[Object(et.jsx)("h4",{children:"Add friends to the room"}),Object(et.jsx)("div",{className:"list_friend",children:d.map((function(e){return Object(et.jsxs)("div",{className:"friend",children:[Object(et.jsxs)("div",{className:"friend-info",children:[Object(et.jsx)(lt,{user:e,link:!1,isStatus:!1}),Object(et.jsx)("p",{className:"friend-name",children:null===e||void 0===e?void 0:e.userName})]}),Object(et.jsx)("div",{className:"button-actions",children:Object(et.jsx)("button",{type:"button",className:"btn btn-success",onClick:function(){return b({type:be,payload:e})},children:"Add"})})]},null===e||void 0===e?void 0:e._id)}))})]}),Object(et.jsxs)("div",{className:"content-right",children:[Object(et.jsx)("h4",{children:"Room information you want to create"}),Object(et.jsxs)("div",{className:"form-group",children:[Object(et.jsx)("label",{htmlFor:"name-room",children:"Name Room"}),Object(et.jsx)("input",{ref:a,type:"text",className:"form-control",id:"name-room",placeholder:"abc",required:!0})]}),Object(et.jsxs)("div",{className:"form-group",children:[Object(et.jsx)("label",{htmlFor:"desc-room",children:"Description"}),Object(et.jsx)("input",{ref:i,type:"text",className:"form-control",id:"desc-room",placeholder:"abc"})]}),Object(et.jsxs)("div",{className:"custom-file",children:[Object(et.jsx)("input",{onChange:function(e){return r(e.target.files[0])},type:"file",className:"custom-file-input",id:"validatedCustomFile"}),Object(et.jsx)("label",{className:"custom-file-label",htmlFor:"validatedCustomFile",children:"Choose Avatar..."})]}),Object(et.jsx)("div",{className:"display_room_avatar",children:n&&Object(et.jsx)("img",{src:URL.createObjectURL(n),alt:""})}),j.length>0&&Object(et.jsxs)(et.Fragment,{children:[Object(et.jsx)("h5",{className:"members mt-4",children:"members"}),Object(et.jsx)("div",{className:"list_friend",children:j.map((function(e){return Object(et.jsxs)("div",{className:"friend",children:[Object(et.jsxs)("div",{className:"friend-info",children:[Object(et.jsx)(lt,{user:e,link:!1,isStatus:!1}),Object(et.jsx)("p",{className:"friend-name",children:null===e||void 0===e?void 0:e.userName})]}),Object(et.jsx)("div",{className:"button-actions",children:Object(et.jsx)("button",{type:"button",className:"btn btn-success",onClick:function(){return b({type:fe,payload:e})},children:"Delete"})})]},null===e||void 0===e?void 0:e._id)}))})]})]})]}),Object(et.jsxs)("div",{className:"footer",children:[Object(et.jsx)("button",{type:"button",className:"btn btn-danger",onClick:m,children:"Cancel"}),Object(et.jsx)("button",{type:"button",className:"btn btn-info",onClick:p,children:"Save"})]})]})})},Gt=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.chat})).friendChat,n=Object(s.c)((function(e){return e.chat})).conversationChat._id,r=Object(s.c)((function(e){return e.network})).socket,a=Object(s.c)((function(e){return e.peer})),i=Object(s.c)((function(e){return e.auth})).userCurrent,o=Object(s.c)((function(e){return e.call})),l=o.userStream,u=o.isCall,d=o.isVideo,j=o.userReciverCall,b=o.roomCallId,O=o.isAnswer,m=o.conversationId,p=function(){var c=Object(v.a)(Object(f.a)().mark((function c(s){var o,l,u,d,j,b;return Object(f.a)().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,yt("/room-chat?conversationId=".concat(n));case 3:return o=c.sent,l=o.roomCall,c.next=7,C(s);case 7:if(u=c.sent,e({type:K,payload:u}),!l){c.next=18;break}if(d=l.conversationId,j=l.isVideo,b=l.roomCallId,e({type:B,payload:{isVideo:j,isAnswer:!0,isCall:!0,isCreate:!1,conversationId:d}}),I(u,!0),r){c.next=15;break}return c.abrupt("return");case 15:r.emit("joinRoomCall",{roomCallId:b,peerId:a._id,isCreate:!1,conversationId:d,isVideo:j,isNext:!0,userJoinCallId:null===i||void 0===i?void 0:i._id,userName:null===i||void 0===i?void 0:i.userName,streamId:u.id}),c.next=19;break;case 18:e({type:B,payload:{isVideo:s,userSenderCall:null,userReciverCall:t,isSenderCall:!0,roomCallId:Object(N.a)(),isCall:!0,isCreate:!0,conversationId:n}});case 19:c.next=24;break;case 21:c.prev=21,c.t0=c.catch(0),console.log("err",{err:c.t0});case 24:case"end":return c.stop()}}),c,null,[[0,21]])})));return function(e){return c.apply(this,arguments)}}();return Object(c.useEffect)((function(){r&&i&&u&&l&&(O||null===r||void 0===r||r.emit("createCall",{isVideo:d,sender:{profilePicture:i.profilePicture,userName:i.userName,_id:null===i||void 0===i?void 0:i._id},conversationId:m,receiverId:null===j||void 0===j?void 0:j._id,roomCallId:b,isCreate:!0,streamId:l.id}))}),[r,i,u,l,O]),Object(et.jsx)(et.Fragment,{children:Object(et.jsxs)("div",{className:"icon-call",children:[Object(et.jsx)("i",{className:"fa-solid fa-phone",onClick:function(){return p(!1)}}),Object(et.jsx)("i",{className:"fa-solid fa-video",onClick:function(){return p(!0)}})]})})},Ht=function(){var e=Object(s.c)((function(e){return e.message})).files,t=Object(s.b)();return Object(et.jsx)("div",{className:"display-image-message",style:{padding:"".concat(e.length&&"10px")},children:e.map((function(e){return Object(et.jsxs)("div",{className:"imgMessage",children:[Object(et.jsx)("img",{src:URL.createObjectURL(e)}),Object(et.jsx)("span",{className:"imgCancel",onClick:function(){return t({type:ke,payload:e.uuid})},children:Object(et.jsx)(Dt.a,{})})]},e.uuid)}))})},Jt=function(e){var t=e.createNewMessage,n=Object(c.useState)(!1),r=Object(O.a)(n,2),a=r[0],i=r[1],o=Object(c.useRef)(),l=Object(s.c)((function(e){return e.message})).files,u=Object(s.c)((function(e){return e.chat})).conversationChat,d=Object(s.c)((function(e){return e.network})).socket,j=Object(s.b)();Object(c.useEffect)((function(){var e;a&&(null===d||void 0===d||d.emit("typing",{receiverId:null===u||void 0===u||null===(e=u.friend)||void 0===e?void 0:e._id,conversationId:null===u||void 0===u?void 0:u._id}))}),[a]);var b=function(){t(o.current.value),o.current.value="",o.current.focus()};return Object(et.jsxs)("form",{className:"input ".concat(!u&&"disable"," ").concat(l.length&&"files"),onSubmit:function(e){e.preventDefault(),b()},children:[Object(et.jsx)("label",{htmlFor:null===u||void 0===u?void 0:u._id,className:"icon-camera",children:Object(et.jsx)("i",{className:"fas fa-camera"})}),Object(et.jsx)("input",{style:{display:" none"},type:"file",id:null===u||void 0===u?void 0:u._id,accept:".png,.jpeg,.jpg",multiple:!0,onChange:function(e){var t=Array.from(e.target.files);j({type:_e,payload:[].concat(Object(bt.a)(t.map((function(e){return e.uuid=Object(N.a)(),e}))),Object(bt.a)(l))})}}),Object(et.jsx)("i",{className:"far fa-laugh-beam"}),Object(et.jsxs)("div",{className:"inputContainer",children:[Object(et.jsx)(Ht,{}),Object(et.jsxs)("div",{className:"inputCreate",children:[Object(et.jsx)("input",{ref:o,placeholder:"Aa",type:"text",onChange:function(){return i(!0)},onBlur:function(){return i(!1)}}),Object(et.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAARpJREFUSEu9lIERwUAQRX8qoBNUQgeUoAQqQAd0QAdUgA7ogA7MyyyTObncJhE7kzFD/Hd/999m6riyjvX1d8BFUk/SQtLuF+5CBw8DoH2TtJW0kcT3jSoE7CWNAyXE101BIWAuaRU5KiAOsDR3LkchYCjp7PgnrXOBylJUnEOKhSNmdIy9WAbAxcweEuUpADj6AqXuwcRA4eBjUGJOID4RTwHeQv2Cq4HDEqAR79UBTA1CC1N1lZS/lwLQIoT59BTCtIiU5RUb8vu0tMZTJ1svriHXienBTuyOqfeikRIWIvuqsuqsiqetCpdwbAZlyw5hBsdTe6tWreu7paGRcMwBF4Tk0IZP1FJ9rvo9dQ/aaEfvQWvRokDnDl64CTgZWvgaSwAAAABJRU5ErkJggg==",onClick:b})]})]}),Object(et.jsx)("i",{className:"fas fa-microphone"})]})},Kt=n(320),Yt=n.n(Kt),Wt=function(e){var t=e.message,n=Object(c.useState)(),r=Object(O.a)(n,2),a=(r[0],r[1]),i=Object(s.c)((function(e){return e.chat})).conversationChat.listMembers,o=Object(s.c)((function(e){return e.auth})).userCurrent;return Object(c.useEffect)((function(){var e,n,c;t&&i&&(c=t.senderId===(null===o||void 0===o?void 0:o._id)?Object(b.a)({},o):i.find((function(e){return(null===e||void 0===e?void 0:e._id)===t.senderId})),a({profilePicture:null===(e=c)||void 0===e?void 0:e.profilePicture,userName:null===(n=c)||void 0===n?void 0:n.userName}))}),[t,i,o]),Object(et.jsx)(et.Fragment,{children:null!==t&&void 0!==t&&t.isNotify?null!==t&&void 0!==t&&t.senderId?Object(et.jsx)("div",{className:"message ".concat(t.senderId===(null===o||void 0===o?void 0:o._id)?"user":"friend"),children:t.senderId===(null===o||void 0===o?void 0:o._id)?null===t||void 0===t?void 0:t.notify[0]:null===t||void 0===t?void 0:t.notify[1]}):Object(et.jsx)("div",{className:"message notify",children:t.notify[0]}):(null===t||void 0===t?void 0:t.text)&&Object(et.jsx)("div",{className:"message ".concat(t.senderId===(null===o||void 0===o?void 0:o._id)?"user":"friend"),children:t.text})})},Zt=function(e){var t=e.updateConversation,n=e.messages,r=e.setMessages,a=Object(s.c)((function(e){return e.auth})).userCurrent,i=Object(s.c)((function(e){return e.chat})).conversationChat,o=Object(s.c)((function(e){return e.network})).socket,l=Object(s.b)(),u=Object(c.useRef)();Object(c.useEffect)((function(){u.current&&u.current.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}),[n]);var d=function(){var e=Object(v.a)(Object(f.a)().mark((function e(c){var s,u,d,j;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n[n.length-1],e.prev=1,e.next=4,It("/message/".concat(null===c||void 0===c?void 0:c._id));case 4:u=e.sent,d=null,(null===s||void 0===s?void 0:s._id)===(null===c||void 0===c?void 0:c._id)&&(d={conversationId:c.conversationId,senderId:null===a||void 0===a?void 0:a._id,message:" has withdrawn the message"},t({conversationId:null===c||void 0===c?void 0:c.conversationId,lastMessage:[null===a||void 0===a?void 0:a._id," has withdrawn the message"]}),l({type:Z,payload:d})),j=u.newMessage,r((function(e){return e.map((function(e){return e._id==(null===j||void 0===j?void 0:j._id)?j:e}))})),o.emit("removeMessage",{newMessage:j,receverId:i.members.find((function(e){return e!==(null===a||void 0===a?void 0:a._id)})),lastMessage:d}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log("err",e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(et.jsx)(et.Fragment,{children:n.map((function(e){return Object(et.jsxs)("div",{className:"messageContent",ref:u,children:[Object(et.jsx)(Wt,{message:e}),!(null!==e&&void 0!==e&&e.notify)&&Object(et.jsx)("div",{className:"imgsContainer ".concat(!(null!==e&&void 0!==e&&e.text)&&"add-space"," ").concat(e.senderId===(null===a||void 0===a?void 0:a._id)?"user":"friend"),children:Object(et.jsx)("div",{className:"imgs ",children:e.images.map((function(e){return Object(et.jsx)("div",{className:"img",children:Object(et.jsx)("img",{src:e.url})},e.public_id)}))})}),Object(et.jsx)("div",{className:"time ".concat((null===e||void 0===e?void 0:e.notify)?"notify":e.senderId===(null===a||void 0===a?void 0:a._id)&&"user"),children:Yt()(null===e||void 0===e?void 0:e.createdAt).format("HH:mm")}),!e.isDeleted&&e.senderId===(null===a||void 0===a?void 0:a._id)&&Object(et.jsxs)("span",{className:"CrudMessage",children:[Object(et.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAFBJREFUSEtjZKAxYKSx+Qwjy4L/aMFJlO+JUgQ1eNQC2iRYUuKALBeQYsFoJBMMYpoHEUEXYFNASiTT3AKaB9GoBWTFIUFNgyoVEXTtgOQDAEM9DBleh0KcAAAAAElFTkSuQmCC"}),Object(et.jsx)("div",{className:"buttonActions",children:Object(et.jsx)("button",{type:"button",onClick:function(){return d(e)},children:"Remove"})})]})]},null===e||void 0===e?void 0:e._id)}))})},zt=function(){return Object(et.jsx)(et.Fragment,{children:Object(et.jsxs)("div",{className:"message stark",children:[Object(et.jsx)("div",{className:"typing typing-1"}),Object(et.jsx)("div",{className:"typing typing-2"}),Object(et.jsx)("div",{className:"typing typing-3"})]})})},Xt=function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},$t=function(e,t){return e.includes(t)},en=function(e,t,n){return e.length>=n?"":"".concat(t," must be at least ").concat(n," characters long")},tn=function(e,t,n){return n&&n(e,t)||$t(e,t)?e:[].concat(Object(bt.a)(e),[t])},nn=function(){var e=Object(c.useState)([]),t=Object(O.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(!1),i=Object(O.a)(a,2),o=i[0],l=i[1],u=Object(s.c)((function(e){return e.chat})).conversationChat,d=Object(s.c)((function(e){return e.network})).socket,j=Object(s.c)((function(e){return e.auth})).userCurrent,b=Object(s.c)((function(e){return e.message})).files,m=Object(s.b)();Object(c.useEffect)((function(){var e=!0;if(d){var t=function(t){(null===u||void 0===u?void 0:u._id)===t&&e&&l(!0)},n=function(e){var t=e.newMessage,n=e.lastMessage;n&&m({type:Z,payload:n}),(null===t||void 0===t?void 0:t.conversationId)===(null===u||void 0===u?void 0:u._id)&&r((function(e){return e.map((function(e){return(null===e||void 0===e?void 0:e._id)===(null===t||void 0===t?void 0:t._id)?t:e}))}))},c=function(e){e.userDisconnectId,e.time};return d.on("displayTyping",t),d.on("updateMessage",n),d.on("friendLogout",c),function(){e=!1,null===d||void 0===d||d.off("displayTyping",t),null===d||void 0===d||d.off("updateMessage",n),null===d||void 0===d||d.off("friendLogout",c)}}}),[d]),Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(v.a)(Object(f.a)().mark((function t(){var n,c;return Object(f.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===u||void 0===u||!u._id){t.next=12;break}return t.prev=1,t.next=4,yt("/message/".concat(u._id));case 4:n=t.sent,n.message,c=n.messages,e&&r(c),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("err",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}();return u&&t(),function(){return e=!1}}),[u]),Object(c.useEffect)((function(){var e=function(e){var t=e.newMessage,n=e.receiverId,c=t.conversationId;t.text,t.senderId;m({type:Z,payload:t}),u&&c===u._id&&(h({receiverId:n,conversationId:c,isRead:!0}),r((function(e){return tn(e,t,(function(e,t){return e.find((function(e){return(null===e||void 0===e?void 0:e._id)===(null===t||void 0===t?void 0:t._id)}))}))}),!1),l(!1))};return null===d||void 0===d||d.on("getMessage",e),function(){null===d||void 0===d||d.off("getMessage",e)}}),[d,u]);var p,h=function(){var e=Object(v.a)(Object(f.a)().mark((function e(t){var n;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_t("/conversation/update-conversation",t);case 3:n=e.sent,n.message,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("err",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(v.a)(Object(f.a)().mark((function e(t){var n,c,a,i;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t||b.length){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,n={conversationId:null===u||void 0===u?void 0:u._id,senderId:null===j||void 0===j?void 0:j._id},t&&(n.text=t),e.next=7,it(b);case 7:return c=e.sent,n.images=Object(bt.a)(c),e.next=11,_t("/message",n);case 11:a=e.sent,a.message,i=a.newMessage,h({conversationId:null===u||void 0===u?void 0:u._id,reads:[null===j||void 0===j?void 0:j._id]}),m({type:Z,payload:i}),m({type:_e,payload:[]}),null===d||void 0===d||d.emit("sendMessage",{receivers:u.members,newMessage:i}),r((function(e){return[].concat(Object(bt.a)(e),[i])})),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(2),console.log("err",e.t0);case 23:case"end":return e.stop()}}),e,null,[[2,20]])})));return function(t){return e.apply(this,arguments)}}();return Object(et.jsxs)(et.Fragment,{children:[Object(et.jsx)("div",{className:"contact bar",children:u&&Object(et.jsxs)(et.Fragment,{children:[Object(et.jsx)("div",{className:"pic",children:u.images&&(1===u.images.length?Object(et.jsx)("img",{className:"one-img",src:u.images[0].src,alt:""}):Object(et.jsx)("div",{className:"multiple-img",children:u.images.map((function(e){return Object(et.jsx)("img",{src:e.src},e.key)}))}))}),Object(et.jsx)("div",{className:"contact-info",children:Object(et.jsx)("div",{className:"name",children:(p=u.nameConversation,p.length>=10?p.substring(0,10)+"...":p.length)})}),Object(et.jsx)(Gt,{})]})}),Object(et.jsx)("div",{className:"messages",id:"chat",children:u?Object(et.jsxs)("div",{className:"messagesContainer",children:[Object(et.jsx)(Zt,{updateConversation:h,setMessages:r,messages:n}),o&&Object(et.jsx)(zt,{})]}):Object(et.jsx)(dt,{mess:"Ch\u1ecdn B\u1ea1n \u0110\u1ec3 Chat"})}),Object(et.jsx)(Jt,{createNewMessage:x})]})},cn=(n(649),function(){var e=Object(c.useState)(0),t=Object(O.a)(e,2),n=t[0],r=t[1],a=Object(s.c)((function(e){return e.chat})).listConversation,i=Object(s.c)((function(e){return e.auth})).userCurrent,o=Object(s.b)();Object(c.useEffect)((function(){if(a&&i){var e=i._id,t=a.reduce((function(t,n){return n.status.includes(e)?t:t+1}),0);r(t)}}),[a,i]);return Object(et.jsxs)("h2",{className:"options-message",onClick:function(){o({type:ne,payload:!0})},children:[Object(et.jsxs)("div",{className:"number",children:[Object(et.jsx)("i",{className:"fa-solid fa-message"}),Object(et.jsx)("span",{children:n})]}),"Message waiting"]})});function rn(){var e=Object(c.useState)([]),t=Object(O.a)(e,2),n=t[0],r=t[1],a=Object(s.c)((function(e){return e.auth})).userCurrent,i=Object(s.c)((function(e){return e.createRoomChat})).isCreate,o=Object(s.c)((function(e){return e.chat})),l=o.conversationChat,u=o.listConversation,d=o.isShowConversationPending,j=Object(s.b)();Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(v.a)(Object(f.a)().mark((function t(){var n,c;return Object(f.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=13;break}return t.prev=1,t.next=4,yt("/conversation/get-all-conversations");case 4:n=t.sent,n.message,c=(c=n.conversations).map((function(e){return e.roomCallId?Object(b.a)(Object(b.a)({},e),{},{lastMessage:["notify","Conversation going on"]}):e})),e&&j({type:ee,payload:{userId:null===a||void 0===a?void 0:a._id,conversations:c}}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),console.log("err",t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){return e=!1}}),[a]),Object(c.useEffect)((function(){if(u&&a){var e,t=a._id;e=d?u.filter((function(e){return!e.status.includes(t)})):u.filter((function(e){return e.status.includes(t)})),r(e)}}),[u,d,a]);var m=function(){var e=Object(v.a)(Object(f.a)().mark((function e(t){var n,c,r,i,s;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l&&(null===t||void 0===t?void 0:t._id)===l._id){e.next=12;break}if(n=a._id,c=t.status,r=t.reads,i={},s=!1,c.includes(n)||(s=!0,i.status=[].concat(Object(bt.a)(c),[n])),r.includes(n)||(i.reads=[].concat(Object(bt.a)(r),[n])),!Object.entries(i).length){e.next=11;break}return e.next=10,_t("/conversation/update-conversation",Object(b.a)({conversationId:null===t||void 0===t?void 0:t._id},i));case 10:e.sent;case 11:j({type:te,payload:{conversationChat:Object(b.a)(Object(b.a)({},t),i),isChangeType:s}});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(et.jsxs)(et.Fragment,{children:[Object(et.jsxs)("div",{className:"center",children:[Object(et.jsxs)("div",{className:"contacts",children:[Object(et.jsxs)("div",{className:"options-chat",children:[Object(et.jsx)("i",{className:"fas fa-bars fa-2x"}),Object(et.jsx)("div",{className:"list_options_chat",children:Object(et.jsx)("button",{onClick:function(){j({type:je,payload:!0})},children:"Create chat room"})})]}),Object(et.jsx)(cn,{}),Object(et.jsx)("div",{className:"contacts-container",children:n&&n.map((function(e){return Object(et.jsx)("div",{className:"contact",onClick:function(){m(e)},children:Object(et.jsx)(Vt,{conversation:e})},null===e||void 0===e?void 0:e._id)}))})]}),Object(et.jsx)("div",{className:"chat",children:Object(et.jsx)(nn,{conversationChat:l})})]}),i&&Object(et.jsx)(Qt,{})]})}var an=function(){var e=Object(c.useState)(0),t=Object(O.a)(e,2),n=t[0],r=t[1],a=Object(s.c)((function(e){return e.chat})),i=a.isChat,o=a.conversationUnReads,l=Object(s.c)((function(e){return e.global})).elClick,u=Object(s.c)((function(e){return e.network})).socket,d=Object(s.c)((function(e){return e.chat})).conversationChat,j=Object(s.b)(),b=Object(c.useRef)();Object(c.useEffect)((function(){l&&(b.current.contains(l)||l.classList.contains("messSkip")||j({type:$,payload:{isChat:!1}}))}),[l]),Object(c.useEffect)((function(){o&&r(o.length)}),[o]),Object(c.useEffect)((function(){var e=function(e){var t=e.newMessage.conversationId;d&&(null===d||void 0===d?void 0:d._id)===t||o.includes(t)||j({type:se})};return null===u||void 0===u||u.on("getMessage",e),function(){null===u||void 0===u||u.off("getMessage",e)}}),[u,o,d]);return Object(et.jsxs)("div",{ref:b,children:[Object(et.jsx)(Bt.a,{onClick:function(){var e={isChat:!i};i&&(e.conversationChat=null),j({type:$,payload:e})}}),Object(et.jsx)("span",{className:"topbarIconBadge",children:n}),i&&Object(et.jsx)(rn,{})]})},sn=n(717),on=(n(650),function(e){var t=e.notification,n=Object(s.b)(),c=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var c,r;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,It("/notification/".concat(t._id));case 3:c=e.sent,r=c.message,l.b.success(r,{autoClose:1e3}),n({type:Ue,payload:null===t||void 0===t?void 0:t._id}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("err",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),r=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var c,r,a;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ct("/notification/unRead/".concat(t._id));case 3:c=e.sent,r=c.message,a=c.newNotification,l.b.success(r,{autoClose:1e3}),n({type:Ve,payload:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("err",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),a=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var c,r,a;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ct("/notification/".concat(t._id));case 3:c=e.sent,r=c.message,a=c.newNotification,l.b.success(r,{autoClose:1e3}),n({type:Ve,payload:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("err",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return Object(et.jsx)(et.Fragment,{children:Object(et.jsxs)("div",{className:"notificationCrudAction",children:[Object(et.jsx)("button",{className:"".concat(t.isRead?"disable":""," "),onClick:a,children:"Mark"}),Object(et.jsx)("button",{onClick:r,className:"".concat(t.isRead?"":"disable"," "),children:"Unread"}),Object(et.jsx)("button",{onClick:c,children:"Remove"})]})})}),ln=function(e){var t,n=e.notification,r=Object(c.useState)(null),a=Object(O.a)(r,2),i=a[0],o=a[1],l=Object(s.c)((function(e){return e.auth})).userCurrent,u=Object(d.m)(),j=Object(s.b)();Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(v.a)(Object(f.a)().mark((function t(){var c,r;return Object(f.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==n&&void 0!==n&&n.senderId){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,yt("/user?userId=".concat(null===n||void 0===n?void 0:n.senderId));case 5:c=t.sent,r=c.user,e&&o(r),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),console.log("err",t.t0);case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){e=!1}}),[n]);var b=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t,c;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n&&(null===n||void 0===n||!n.isRead)&&l){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Ct("/notification/".concat(null===n||void 0===n?void 0:n._id));case 5:t=e.sent,t.message,c=t.notification,j({type:Ve,payload:c}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("err",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return Object(et.jsxs)(et.Fragment,{children:[Object(et.jsx)("div",{className:"circle"}),Object(et.jsx)("span",{className:"time",children:ze.a(null===n||void 0===n?void 0:n.createdAt)}),Object(et.jsxs)("p",{className:"".concat(null!==n&&void 0!==n&&n.isRead?"read":""),onClick:function(){b(),u(null===n||void 0===n?void 0:n.link)},children:[Object(et.jsx)("b",{children:null===i||void 0===i?void 0:i.userName}),null===n||void 0===n?void 0:n.text.slice((null===n||void 0===n?void 0:n.text.indexOf(null===i||void 0===i?void 0:i.userName))+(null===i||void 0===i||null===(t=i.userName)||void 0===t?void 0:t.length))]}),Object(et.jsx)(on,{notification:n})]})},un=function(e,t){for(var n=arguments.length,c=new Array(n>2?n-2:0),r=2;r<n;r++)c[r-2]=arguments[r];var a;return t||(t=1e3),function(){a&&(clearTimeout(a),a=null),a=setTimeout((function(){e.apply(void 0,c)}),t)}},dn=function(){var e=Object(s.c)((function(e){return e.notification})),t=e.isShowMenu,n=e.listNotifycation,r=e.type,a=function(e){i({type:Me,payload:e})},i=Object(s.b)();Object(c.useEffect)((function(){var e,t=!0;if(n)return e="all"===r?n:"unread"===r?n.filter((function(e){return!e.isRead})):n.filter((function(e){return e.isRead})),t&&i({type:qe,payload:e}),function(){return t=!1}}),[r]);var o=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t,n;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,It("/notification/delete-all-notification");case 3:t=e.sent,n=t.message,i({type:Be}),l.b.success(n,{autoClose:1e3}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("err",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t,n;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ct("/notification/read-all-notification");case 3:t=e.sent,n=t.message,t.notifications,l.b.success(n,{autoClose:1e3}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("err",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(et.jsx)("div",{className:"menu ".concat(t&&"active"),children:Object(et.jsxs)("ul",{children:[Object(et.jsxs)("li",{className:"hvr-underline-from-left",onClick:un(a,500,"all"),children:[Object(et.jsx)("span",{className:"fa-solid fa-border-all"}),"All"]}),Object(et.jsxs)("li",{className:"hvr-underline-from-left",onClick:un(a,500,"read"),children:[Object(et.jsx)("span",{className:"fa-solid fa-check-double"}),"Read"]}),Object(et.jsxs)("li",{className:"hvr-underline-from-left",onClick:un(a,500,"unread"),children:[Object(et.jsx)("span",{className:"fa-solid fa-rectangle-xmark"}),"Un Read"]}),Object(et.jsxs)("li",{className:"hvr-underline-from-left",onClick:un(o,500),children:[Object(et.jsx)("span",{className:"fa-solid fa-trash-can"}),"Remove all"]}),Object(et.jsxs)("li",{className:"hvr-underline-from-left",onClick:un(u,500),children:[Object(et.jsx)("span",{className:"fa-solid fa-marker"}),"Mark"]})]})})},jn=(n(651),function(){var e=Object(s.c)((function(e){return e.notification})),t=e.type,n=e.notificationDisplays,r=e.isShowMenu,a=Object(s.c)((function(e){return e.network})).socket,i=Object(s.b)();return Object(c.useEffect)((function(){if(a){var e=function(e){var n=e.notification;"all"===t&&"read"===t&&i({type:Qe,payload:n}),i({type:Te,payload:n})};return a.on("updateNotification",e),function(){return null===a||void 0===a?void 0:a.off("updateNotification",e)}}}),[a]),Object(et.jsxs)("div",{className:"frame",children:[Object(et.jsxs)("div",{className:"panel ".concat(r&&"show-menu"),children:[Object(et.jsxs)("div",{className:"header flex",children:[Object(et.jsxs)("div",{className:"menu-icon",onClick:function(){return i({type:Ge})},children:[Object(et.jsx)("div",{className:"dash-top ".concat(r&&"slide-top")}),Object(et.jsx)("div",{className:"dash-bottom"}),Object(et.jsx)("div",{className:"circle circle-1 ".concat(r&&"slide")})]}),Object(et.jsx)("span",{className:"title",children:"Notifications"})]}),Object(et.jsxs)("div",{className:"notifications clearfix",children:[Object(et.jsx)("div",{className:"line"}),n&&n.map((function(e,t){return Object(et.jsx)("div",{className:"notification",style:{animation:"here-am-i 0.5s ease-out ".concat(.4+.2*t,"s"),animationFillMode:"both"},children:Object(et.jsx)(ln,{notification:e},null===e||void 0===e?void 0:e._id)},null===e||void 0===e?void 0:e._id)}))]})]}),Object(et.jsx)(dn,{})]})}),bn=(n(652),function(){var e=Object(s.c)((function(e){return e.notification})),t=e.number,n=e.isShow,r=Object(s.c)((function(e){return e.auth})).userCurrent,a=Object(s.c)((function(e){return e.network})).socket,i=Object(s.c)((function(e){return e.global})).elClick,o=Object(s.b)(),l=Object(c.useRef)();Object(c.useEffect)((function(){l.current.contains(i)||o({type:De,payload:!1})}),[i]),Object(c.useEffect)((function(){if(a){var e=function(){n||o({type:Le})};return a.on("updateNotification",e),function(){return null===a||void 0===a?void 0:a.off("updateNotification",e)}}}),[a,n]),Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(v.a)(Object(f.a)().mark((function t(){var c,a,i;return Object(f.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r||!n){t.next=15;break}return t.prev=1,t.next=4,yt("/notification");case 4:c=t.sent,c.message,a=c.notifications,i=[],a.forEach((function(e){!e.isRead&&i.push(e)})),a.forEach((function(e){e.isRead&&i.push(e)})),e&&o({type:Re,payload:i}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),console.log("err",t.t0);case 15:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){return e=!1}}),[r,n]),Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(v.a)(Object(f.a)().mark((function t(){var n,c;return Object(f.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=12;break}return t.prev=1,t.next=4,yt("/notification/get-number-notification-not-read");case 4:n=t.sent,n.message,c=n.number,e&&o({type:Fe,payload:c}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("err",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){return e=!1}}),[r]);return Object(et.jsxs)("div",{ref:l,children:[Object(et.jsx)(sn.a,{className:"svg-notification",style:{cursor:"pointer"},onClick:function(){o({type:De,payload:!n})}}),Object(et.jsx)("span",{className:"topbarIconBadge",children:t}),Object(et.jsx)("div",{className:"my-btn-border-notification"}),Object(et.jsx)("div",{className:"my-btn-1"}),n&&Object(et.jsx)(jn,{})]})}),fn=n(718),vn=(n(653),function(e){var t=e.friendRequest,n=e.user,r=Object(s.c)((function(e){return e.friendRequest})).type,a=Object(s.c)((function(e){return e.network})).socket,i=Object(s.c)((function(e){return e.auth})).userCurrent,o=Object(c.useMemo)((function(){return t.status}),[t]),u=Object(s.b)(),d=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var c,r;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=12;break}return e.next=4,Ct("/friend-request/accept-friend-request",{friendId:null===n||void 0===n?void 0:n._id,friendRequestId:null===t||void 0===t?void 0:t._id});case 4:return c=e.sent,r=c.message,l.b.success(r,{autoClose:1e3}),u({type:xe,payload:null===t||void 0===t?void 0:t._id}),e.next=10,_t("/notification",{link:"",userId:null===n||void 0===n?void 0:n._id,text:(null===i||void 0===i?void 0:i.userName)+" has accepted your friend request"});case 10:e.next=13;break;case 12:l.b.error("An error occurred while making this request!!!",{autoClose:1e3});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.log("err",e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var n,c;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=10;break}return e.next=4,Ct("/friend-request/refuse-request",{friendRequestId:null===t||void 0===t?void 0:t._id});case 4:n=e.sent,u({type:xe,payload:null===t||void 0===t?void 0:t._id}),c=n.message,l.b.success(c,{autoClose:1e3}),e.next=11;break;case 10:l.b.error("An error occurred while making this request!!!",{autoClose:1e3});case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log("err",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var n,c;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=10;break}return e.next=4,It("/friend-request/".concat(null===t||void 0===t?void 0:t._id));case 4:n=e.sent,u({type:xe,payload:null===t||void 0===t?void 0:t._id}),c=n.message,l.b.success(c,{autoClose:1e3}),e.next=11;break;case 10:l.b.error("An error occurred while making this request!!!",{autoClose:1e3});case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log("err",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var c,r,s,o;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=15;break}return e.next=4,Ct("/friend-request",{friendRequestId:null===t||void 0===t?void 0:t._id,status:1});case 4:return c=e.sent,u({type:xe,payload:null===t||void 0===t?void 0:t._id}),r=c.message,l.b.success(r,{autoClose:1e3}),e.next=10,_t("/notification",{link:"",userId:null===n||void 0===n?void 0:n._id,text:(null===i||void 0===i?void 0:i.userName)+" sent a friend request"});case 10:s=e.sent,o=s.notification,null===a||void 0===a||a.emit("createNotification",{notification:o}),e.next=17;break;case 15:throw l.b.error("An error occurred while making this request!!!",{autoClose:1e3}),new Error("Friend Request not Exit");case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.log("err",e.t0);case 22:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(){return e.apply(this,arguments)}}();return Object(et.jsx)("div",{className:"button-actions",children:"received"===r?Object(et.jsxs)(et.Fragment,{children:[Object(et.jsx)("button",{type:"button",className:"btn btn-primary",onClick:d,children:"Accept"}),Object(et.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:j,children:"Refusse"})]}):Object(et.jsx)(et.Fragment,{children:1===o?Object(et.jsx)(et.Fragment,{children:Object(et.jsx)("button",{type:"button",className:"btn btn-warning",onClick:b,children:"Cancel invitation"})}):Object(et.jsxs)(et.Fragment,{children:[Object(et.jsx)("button",{type:"button",className:"btn btn-light",onClick:O,children:"Send to"}),Object(et.jsx)("button",{type:"button",className:"btn btn-danger",onClick:b,children:"Remove"})]})})})}),On=function(e){var t=e.friendRequest,n=Object(c.useState)(),r=Object(O.a)(n,2),a=r[0],i=r[1],o=Object(s.c)((function(e){return e.friendRequest})).type;return Object(c.useEffect)((function(){var e=!0,n=function(){var n=Object(v.a)(Object(f.a)().mark((function n(){var c,r,a;return Object(f.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,c="received"===o?null===t||void 0===t?void 0:t.senderId:null===t||void 0===t?void 0:t.receiverId){n.next=5;break}throw l.b.error("id user not found",{autoClose:1e3}),new Error("id user not found");case 5:return n.next=7,yt("/user?userId=".concat(c));case 7:r=n.sent,a=r.user,e&&i(a),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(0),console.log("err",n.t0);case 15:case"end":return n.stop()}}),n,null,[[0,12]])})));return function(){return n.apply(this,arguments)}}();return n(),function(){return e=!1}}),[]),Object(et.jsx)(et.Fragment,{children:a&&Object(et.jsxs)(et.Fragment,{children:[Object(et.jsxs)("div",{className:"info",children:[Object(et.jsx)(lt,{height:"60px",width:"60px",user:a}),Object(et.jsx)("span",{children:null===a||void 0===a?void 0:a.userName})]}),Object(et.jsx)(vn,{user:a,friendRequest:t})]})})},mn=function(){var e=Object(s.c)((function(e){return e.friendRequest})),t=e.type,n=e.listFriendRequest,r=Object(s.b)();return Object(c.useEffect)((function(){var e=!0,n=function(){var n=Object(v.a)(Object(f.a)().mark((function n(){var c,a;return Object(f.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=12;break}return n.prev=1,n.next=4,yt("/friend-request/get-all-requests-".concat(t));case 4:c=n.sent,c.message,a=c.friendRequests,e&&r({type:pe,payload:a}),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),console.log("err",n.t0);case 12:case"end":return n.stop()}}),n,null,[[1,9]])})));return function(){return n.apply(this,arguments)}}();return n(),function(){return e=!1}}),[t]),Object(et.jsx)(et.Fragment,{children:n&&n.map((function(e){return Object(et.jsx)("div",{className:"friendRequest",children:Object(et.jsx)(On,{friendRequest:e})},null===e||void 0===e?void 0:e._id)}))})},pn=function(){var e=Object(s.b)();return Object(et.jsxs)("div",{className:"boxFriendRequest nav-item dropdown",children:[Object(et.jsx)("h3",{className:"title",children:"Options"}),Object(et.jsxs)("div",{className:"button-options",children:[Object(et.jsx)("button",{type:"button",className:"btn btn-success",onClick:function(){return e({type:me,payload:"received"})},children:"Friend request received"}),Object(et.jsx)("button",{type:"button",className:"btn btn-dark",onClick:function(){return e({type:me,payload:"sent"})},children:"Friend request sent"})]}),Object(et.jsx)(mn,{}),Object(et.jsx)("div",{className:"friendRequest"})]})},hn=function(){var e=Object(c.useState)(!1),t=Object(O.a)(e,2),n=t[0],r=t[1],a=Object(s.c)((function(e){return e.friendRequest})).number,i=Object(s.c)((function(e){return e.global})).elClick,o=Object(c.useRef)();return Object(c.useEffect)((function(){o.current.contains(i)||r(!1)}),[i]),Object(et.jsxs)("div",{ref:o,children:[Object(et.jsx)(fn.a,{onClick:function(){return r((function(e){return!e}))}}),n&&Object(et.jsx)(pn,{}),Object(et.jsx)("span",{className:"topbarIconBadge",children:a})]})},xn=n(719),gn=function(){var e=Object(c.useState)(),t=Object(O.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(!1),i=Object(O.a)(a,2),o=i[0],l=i[1],u=Object(c.useRef)(),j=Object(c.useRef)(),b=Object(d.m)(),m=Object(s.c)((function(e){return e.global})).elClick;Object(c.useEffect)((function(){j.current.contains(m)||l(!1)}),[m]);var p=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t,n,c;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==u&&void 0!==u&&null!==(t=u.current)&&void 0!==t&&t.value){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,yt("/user/search-user/".concat(u.current.value));case 5:n=e.sent,(c=n.users).length&&(l(!0),r(c)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log("err",e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}();return Object(et.jsxs)("div",{className:"searchbar",ref:j,children:[Object(et.jsx)(xn.a,{className:"searchIcon"}),Object(et.jsx)("input",{ref:u,placeholder:"Search for friend, post or video",className:"searchInput",onFocus:function(){o||l(!0)},onChange:un(p,2e3)}),n&&o&&Object(et.jsx)("div",{className:"displayUsersSearch",children:n.map((function(e){return Object(et.jsxs)("div",{className:"userSearchContainer",onClick:function(){return b("/profile/".concat(null===e||void 0===e?void 0:e._id))},children:[Object(et.jsx)(lt,{user:e}),Object(et.jsx)("span",{children:null===e||void 0===e?void 0:e.userName})]},null===e||void 0===e?void 0:e._id)}))})]})};n(654);function Nn(){var e=Object(c.useState)([]),t=Object(O.a)(e,2),n=(t[0],t[1]),r=Object(c.useState)(!1),a=Object(O.a)(r,2),i=(a[0],a[1]),l=Object(s.c)((function(e){return e.network})).socket,u=Object(s.c)((function(e){return e.auth})).userCurrent,j=Object(s.b)(),b=Object(d.m)();Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(v.a)(Object(f.a)().mark((function t(){var n,c;return Object(f.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,yt("/friend-request/get-number");case 3:n=t.sent,c=n.number,e&&j({type:Ne,payload:c}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log("err",t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){return e=!1}}),[]),Object(c.useEffect)((function(){var e=function(){j({type:ge})};return l&&l.on("updateNotification",e),function(){return null===l||void 0===l?void 0:l.off("updateNotification",e)}}),[l]),Object(c.useEffect)((function(){var e=!0,t=function(t){var c=t.notification;e&&(n((function(e){return[c].concat(Object(bt.a)(e))})),i(!1))};return l&&l.on("updateNotification",t),function(){e=!1,null===l||void 0===l||l.off("updateNotification",t)}}),[l]),Object(c.useEffect)((function(){var e=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t,n;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u){e.next=12;break}return e.prev=1,e.next=4,yt("/conversation/get-status-conversation");case 4:t=e.sent,n=t.conversations,j({type:X,payload:n}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log("err",e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();return e(),function(){return!1}}),[u]);return Object(et.jsxs)("div",{className:"topbarContainer",children:[Object(et.jsx)("div",{className:"topbarLeft",children:Object(et.jsx)(o.b,{to:"/",style:{textDecoration:"none"},children:Object(et.jsx)("span",{className:"logo",children:"CoderNoob"})})}),Object(et.jsx)("div",{className:"topbarCenter",children:Object(et.jsx)(gn,{})}),Object(et.jsxs)("div",{className:"topbarRight",children:[Object(et.jsxs)("div",{className:"topbarLinks",children:[Object(et.jsx)("span",{className:"topbarLink",children:"Homepage"}),Object(et.jsx)("span",{className:"topbarLink",children:"Timeline"})]}),Object(et.jsxs)("div",{className:"topbarIcons",children:[Object(et.jsx)("div",{className:"topbarIconItem",children:Object(et.jsx)(hn,{})}),Object(et.jsx)("div",{className:"topbarIconItem",children:Object(et.jsx)(an,{})}),Object(et.jsx)("div",{className:"topbarIconItem",children:Object(et.jsx)(bn,{})})]}),Object(et.jsx)("div",{onClick:function(){j({type:q}),localStorage.setItem(p,""),localStorage.setItem(m,""),localStorage.setItem("userId",""),null===l||void 0===l||l.emit("userLogOut",null===u||void 0===u?void 0:u._id),b("/login")},className:"logout",children:Object(et.jsx)("i",{className:"fa-solid fa-right-from-bracket topbarImg"})})]})]})}n(655);var yn=function(e){var t=e.text,n=e.id,c=e.type;return Object(et.jsx)("div",{className:"updateImage ".concat(c),children:Object(et.jsxs)("button",{"data-toggle":"modal","data-target":"#".concat(n),className:"shareOption",children:[Object(et.jsx)(Pt.a,{htmlColor:"tomato",className:"shareIcon"}),Object(et.jsx)("span",{className:"shareOptionText",children:t})]})})},_n=(n(656),n(657),function(){return Object(et.jsxs)("ul",{className:"button-socials",children:[Object(et.jsx)("li",{children:Object(et.jsx)("span",{className:"facebook",children:Object(et.jsx)("i",{className:"fab fa-facebook ","aria-hidden":"true"})})}),Object(et.jsx)("li",{children:Object(et.jsx)("span",{className:"twitter",children:Object(et.jsx)("i",{className:"fab fa-twitter ","aria-hidden":"true"})})}),Object(et.jsx)("li",{children:Object(et.jsx)("span",{className:"google",children:Object(et.jsx)("i",{className:"fab fa-google-plus-g ","aria-hidden":"true"})})}),Object(et.jsx)("li",{children:Object(et.jsx)("span",{className:"linkedin",children:Object(et.jsx)("i",{className:"fab fa-linkedin ","aria-hidden":"true"})})}),Object(et.jsx)("li",{children:Object(et.jsx)("span",{className:"instagram",children:Object(et.jsx)("i",{className:"fab fa-instagram ","aria-hidden":"true"})})})]})}),Cn=function(e){var t,n,c,r=e.idAvatar,a=Object(s.c)((function(e){return e.profile})).userProfile,i=Object(s.c)((function(e){return e.auth})).userCurrent;return Object(et.jsxs)("div",{className:"left col-lg-4",children:[Object(et.jsxs)("div",{className:"photo-left",children:[Object(et.jsx)(lt,{className:"profile",width:"200px",height:"200px",user:a,isShowOffline:!1,link:!1}),(null===a||void 0===a?void 0:a._id)===(null===i||void 0===i?void 0:i._id)&&Object(et.jsx)(yn,{id:r.current,type:"avatar"})]}),Object(et.jsx)("h4",{className:"name",children:null===a||void 0===a?void 0:a.userName}),Object(et.jsx)("p",{className:"info",children:null===a||void 0===a?void 0:a.email}),Object(et.jsxs)("div",{className:"stats row",children:[Object(et.jsxs)("div",{className:"stat col-4",children:[Object(et.jsx)("p",{className:"number-stat",children:null===a||void 0===a||null===(t=a.followers)||void 0===t?void 0:t.length}),Object(et.jsx)("p",{className:"desc-stat",children:"Followers"})]}),Object(et.jsxs)("div",{className:"stat col-4",children:[Object(et.jsx)("p",{className:"number-stat",children:null===a||void 0===a||null===(n=a.followings)||void 0===n?void 0:n.length}),Object(et.jsx)("p",{className:"desc-stat",children:"Following"})]}),Object(et.jsxs)("div",{className:"stat col-4",children:[Object(et.jsx)("p",{className:"number-stat",children:null===a||void 0===a||null===(c=a.friends)||void 0===c?void 0:c.length}),Object(et.jsx)("p",{className:"desc-stat",children:"Friend"})]})]}),Object(et.jsx)("p",{className:"desc",children:null===a||void 0===a?void 0:a.desc}),Object(et.jsx)(_n,{})]})},kn=(n(658),function(e){var t=e.onEdit,n=Object(s.c)((function(e){return e.auth})).userCurrent,r=Object(s.b)(),a=Object(c.useRef)(),i=Object(c.useRef)(),o=Object(c.useRef)(),u=Object(c.useRef)(),d=Object(c.useRef)(),j=function(){var e=Object(v.a)(Object(f.a)().mark((function e(c){var s,j,b;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.preventDefault(),a.current.value){e.next=3;break}return e.abrupt("return",l.b.error("This field cannot be left blank",{autoClose:1e3}));case 3:return e.prev=3,s={userName:a.current.value,phone:i.current.value,address:o.current.value,relationship:d.current.value,desc:u.current.value,userId:null===n||void 0===n?void 0:n._id},e.next=7,kt("/user/update-user",s);case 7:j=e.sent,j.message,b=j.user,r({type:T,payload:b}),t(!1),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),console.log("err",e.t0);case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(et.jsxs)("form",{className:"edit-profile",onSubmit:j,children:[Object(et.jsxs)("div",{className:"page",children:[Object(et.jsxs)("label",{className:"field field_v1",children:[Object(et.jsx)("input",{defaultValue:(null===n||void 0===n?void 0:n.userName)||"",ref:a,className:"field__input",placeholder:"e.g Coder Noob"}),Object(et.jsx)("span",{className:"field__label-wrap",children:Object(et.jsx)("span",{className:"field__label",children:"Full name"})})]}),Object(et.jsxs)("label",{className:"field field_v2",children:[Object(et.jsx)("input",{defaultValue:null===n||void 0===n?void 0:n.email,className:"field__input",placeholder:"abc@gmail.com",disabled:!0}),Object(et.jsx)("span",{className:"field__label-wrap",children:Object(et.jsx)("span",{className:"field__label",children:"Email"})})]}),Object(et.jsxs)("label",{className:"field field_v3",children:[Object(et.jsx)("input",{defaultValue:(null===n||void 0===n?void 0:n.address)||"",ref:o,className:"field__input",placeholder:"e.g Nam Dinh, Viet Nam"}),Object(et.jsx)("span",{className:"field__label-wrap",children:Object(et.jsx)("span",{className:"field__label",children:"Address"})})]}),Object(et.jsxs)("label",{className:"field field_v2",children:[Object(et.jsx)("input",{defaultValue:(null===n||void 0===n?void 0:n.phone)||"",ref:i,className:"field__input",placeholder:"e.g (+84) 0399738474"}),Object(et.jsx)("span",{className:"field__label-wrap",children:Object(et.jsx)("span",{className:"field__label",children:"Phone"})})]}),Object(et.jsxs)("label",{className:"field field_v3",children:[Object(et.jsx)("input",{defaultValue:(null===n||void 0===n?void 0:n.desc)||"",ref:u,className:"field__input",placeholder:"Fill in what you like"}),Object(et.jsx)("span",{className:"field__label-wrap",children:Object(et.jsx)("span",{className:"field__label",children:"Description"})})]}),Object(et.jsxs)("div",{className:"input-group mb-3",children:[Object(et.jsx)("div",{className:"input-group-prepend",children:Object(et.jsx)("label",{className:"input-group-text",htmlFor:"inputGroupSelect01",children:"Relationship"})}),Object(et.jsxs)("select",{ref:d,className:"custom-select",id:"inputGroupSelect01",children:[Object(et.jsx)("option",{value:"",selected:!0,children:"Choose..."}),Object(et.jsx)("option",{value:"Single",children:"Single"}),Object(et.jsx)("option",{value:"Get married",children:"Get married"}),Object(et.jsx)("option",{value:"Dating",children:"Dating"}),Object(et.jsx)("option",{value:"In a complicated relationship",children:"In a complicated relationship"})]})]})]}),Object(et.jsxs)("div",{className:"linktr",children:[Object(et.jsx)("button",{type:"button",className:"btn btn-danger",onClick:function(){return t(!1)},children:"Cancel"}),Object(et.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Save"})]})]})}),In=function(e){var t=e.onEdit,n=Object(s.c)((function(e){return e.auth})).userCurrent,c=Object(s.c)((function(e){return e.profile})).userProfile;return Object(et.jsx)("div",{className:"col-12",children:Object(et.jsx)("div",{className:"card mb-3",children:Object(et.jsxs)("div",{className:"card-body",children:[Object(et.jsxs)("div",{className:"row",children:[Object(et.jsx)("div",{className:"col-sm-3",children:Object(et.jsx)("h6",{className:"mb-0",children:"Full Name"})}),Object(et.jsx)("div",{className:"col-sm-9 text-secondary",children:null===c||void 0===c?void 0:c.userName})]}),Object(et.jsx)("hr",{}),Object(et.jsxs)("div",{className:"row",children:[Object(et.jsx)("div",{className:"col-sm-3",children:Object(et.jsx)("h6",{className:"mb-0",children:"Email"})}),Object(et.jsx)("div",{className:"col-sm-9 text-secondary",children:null===c||void 0===c?void 0:c.email})]}),Object(et.jsx)("hr",{}),Object(et.jsxs)("div",{className:"row",children:[Object(et.jsx)("div",{className:"col-sm-3",children:Object(et.jsx)("h6",{className:"mb-0",children:"Phone"})}),Object(et.jsx)("div",{className:"col-sm-9 text-secondary",children:null!==c&&void 0!==c&&c.phone?null===c||void 0===c?void 0:c.phone:"Not updated information"})]}),Object(et.jsx)("hr",{}),Object(et.jsxs)("div",{className:"row",children:[Object(et.jsx)("div",{className:"col-sm-3",children:Object(et.jsx)("h6",{className:"mb-0",children:"Relationship"})}),Object(et.jsx)("div",{className:"col-sm-9 text-secondary",children:null!==c&&void 0!==c&&c.relationship?null===c||void 0===c?void 0:c.relationship:"Not updated information"})]}),Object(et.jsx)("hr",{}),Object(et.jsxs)("div",{className:"row",children:[Object(et.jsx)("div",{className:"col-sm-3",children:Object(et.jsx)("h6",{className:"mb-0",children:"Address"})}),Object(et.jsx)("div",{className:"col-sm-9 text-secondary",children:null!==c&&void 0!==c&&c.address?null===c||void 0===c?void 0:c.address:"Not updated information"})]}),Object(et.jsx)("hr",{}),(null===c||void 0===c?void 0:c._id)===(null===n||void 0===n?void 0:n._id)&&Object(et.jsx)("div",{className:"row",children:Object(et.jsx)("div",{className:"col-12",children:Object(et.jsx)("button",{className:"btn btn-info",onClick:function(){return t(!0)},children:"Edit"})})})]})})})},wn=function(e){e.user;var t=Object(c.useState)(!1),n=Object(O.a)(t,2),r=n[0],a=n[1];return Object(et.jsx)(et.Fragment,{children:r?Object(et.jsx)(kn,{onEdit:a}):Object(et.jsx)(In,{onEdit:a})})},En=(n(313),n(659),n(660),function(e){var t=e.children,n=e.length,c={dots:!0,infinite:!0,speed:500,slidesToShow:Math.min(5,n),slidesToScroll:1,lazyLoad:!0,responsive:[{breakpoint:1024,settings:{slidesToShow:Math.min(3,n),slidesToScroll:3,infinite:!0,dots:!0}},{breakpoint:600,settings:{slidesToShow:Math.min(2,n),slidesToScroll:2,initialSlide:2}},{breakpoint:480,settings:{slidesToShow:Math.min(1,n),slidesToScroll:1}}]};return Object(et.jsx)(vt.a,Object(b.a)(Object(b.a)({},c),{},{children:t}))}),An=(n(661),function(){var e=Object(c.useState)([]),t=Object(O.a)(e,2),n=t[0],r=t[1],a=Object(s.c)((function(e){return e.auth})).userCurrent,i=Object(s.c)((function(e){return e.profile})).userProfile;Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(v.a)(Object(f.a)().mark((function t(){var n,c;return Object(f.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!i||!i._id){t.next=12;break}return t.prev=1,t.next=4,yt("/user/get-friends/".concat(null===i||void 0===i?void 0:i._id));case 4:n=t.sent,c=n.friends,e&&r(c),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("err",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){return e=!1}}),[null===i||void 0===i?void 0:i._id,a]);var o=Object(d.m)();return Object(et.jsx)("div",{className:"row friend-container",children:Object(et.jsx)(En,{length:n.length,children:n.map((function(e){var t;return Object(et.jsx)("div",{onClick:function(){return o("/profile/".concat(null===e||void 0===e?void 0:e._id))},children:Object(et.jsxs)("div",{className:"our-friend",children:[Object(et.jsx)("div",{className:"picture",children:Object(et.jsx)("img",{className:"img-fluid",src:(null===e||void 0===e||null===(t=e.profilePicture)||void 0===t?void 0:t.length)&&(null===e||void 0===e?void 0:e.profilePicture[0])||x+"no-avatar.png"})}),Object(et.jsxs)("div",{className:"friend-content",children:[Object(et.jsx)("p",{className:"name",children:null===e||void 0===e?void 0:e.userName}),Object(et.jsx)("h4",{className:"title",children:null===e||void 0===e?void 0:e.desc})]}),Object(et.jsxs)("ul",{className:"social",children:[Object(et.jsx)("li",{children:Object(et.jsx)("i",{className:"fa-brands fa-facebook-square"})}),Object(et.jsx)("li",{children:Object(et.jsx)("i",{className:"fa-brands fa-twitter-square"})}),Object(et.jsx)("li",{children:Object(et.jsx)("i",{className:"fa-brands fa-youtube-square"})}),Object(et.jsx)("li",{children:Object(et.jsx)("i",{className:"fa-brands fa-github-square"})})]})]})},null===e||void 0===e?void 0:e._id)}))})})}),Sn=function(e){var t=e.option,n=e.setOption;return Object(et.jsx)("ul",{className:"nav",children:["friends","about","posts","share","moreOption"].map((function(e){return Object(et.jsx)("li",{className:"".concat(t===e?"choose":""),onClick:function(){return n(e)},children:e[0].toUpperCase()+e.slice(1)},e)}))})},Rn=function(){var e=Object(s.c)((function(e){return e.auth})).userCurrent,t=Object(s.c)((function(e){return e.profile})).userProfile,n=Object(c.useState)((function(){return(null===e||void 0===e?void 0:e.followings.includes(null===t||void 0===t?void 0:t._id))||!1})),r=Object(O.a)(n,2),a=r[0],i=r[1],o=Object(s.b)();Object(c.useEffect)((function(){e&&i(null===e||void 0===e?void 0:e.followings.includes(null===t||void 0===t?void 0:t._id))}),[e,t]);var u=function(){var n=Object(v.a)(Object(f.a)().mark((function n(){var c,r;return Object(f.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null===t||void 0===t||!t._id){n.next=21;break}if(n.prev=1,!a){n.next=9;break}return n.next=5,Ct("/user/unfollow/".concat(t._id),{userId:e._id});case 5:c=n.sent,o({type:F,payload:t._id}),n.next=13;break;case 9:return n.next=11,Ct("/user/follow/".concat(t._id),{userId:e._id});case 11:c=n.sent,o({type:L,payload:t._id});case 13:r=c.message,l.b.success(r,{autoClose:2e3}),i(!a),n.next=21;break;case 18:n.prev=18,n.t0=n.catch(1),console.log("err",n.t0);case 21:case"end":return n.stop()}}),n,null,[[1,18]])})));return function(){return n.apply(this,arguments)}}();return Object(et.jsx)("button",{className:"card__action__button card__action--follow",onClick:u,children:a?"Unfollow":"Follow"})},Tn=function(e){var t=e.id,n=e.onRemove,c=e.text;return Object(et.jsx)(et.Fragment,{children:Object(et.jsx)("div",{className:"modal fade",id:t,tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(et.jsx)("div",{className:"modal-dialog",role:"document",children:Object(et.jsxs)("div",{className:"modal-content",children:[Object(et.jsxs)("div",{className:"modal-header",children:[Object(et.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Confirm"}),Object(et.jsx)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",children:Object(et.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(et.jsx)("div",{className:"modal-body",children:"You confirm to permanently delete this "+c}),Object(et.jsxs)("div",{className:"modal-footer",children:[Object(et.jsx)("button",{type:"button",className:"btn btn-danger",onClick:n,"data-dismiss":"modal",children:"Remove"}),Object(et.jsx)("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal",children:"Close"})]})]})})})})},Fn=function(){var e=Object(c.useState)(),t=Object(O.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(""),i=Object(O.a)(a,2),o=i[0],u=i[1],d=Object(s.c)((function(e){return e.auth})).userCurrent,j=Object(s.c)((function(e){return e.profile})),b=j.userProfile,m=j.isFriend,p=Object(s.c)((function(e){return e.network})).socket,h=Object(c.useRef)(Object(N.a)()),x=Object(c.useRef)(Object(N.a)()),g=Object(s.b)();Object(c.useEffect)((function(){var e=function(e){g({type:U,payload:e})},t=function(e){g({type:M,payload:e})},n=function(e){var t=e.status,n=e.friendRequest;t?(u(t),r(n)):(u(""),r())};return p&&(p.on("addListFriend",e),p.on("removeListFriend",t),p.on("updateStatus",n)),function(){null===p||void 0===p||p.off("addListFriend",e),null===p||void 0===p||p.off("removeListFriend",t),null===p||void 0===p||p.off("updateStatus",n)}}),[p]),Object(c.useEffect)((function(){var e=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t,n;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([yt("/friend-request?friendId=".concat(null===b||void 0===b?void 0:b._id,"&type=sender&status=1")),yt("/friend-request?friendId=".concat(null===b||void 0===b?void 0:b._id,"&type=receive&status=1"))]);case 2:return t=e.sent,n="",t.forEach((function(e){e.message;var t=e.friendRequestDb,c=e.type;t&&(r(t),n=c)})),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=function(){var t=Object(v.a)(Object(f.a)().mark((function t(){var n;return Object(f.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!b||!d){t.next=9;break}if(!m){t.next=5;break}u("friend"),t.next=9;break;case 5:return t.next=7,e();case 7:n=t.sent,u(n);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[b,d]);var y=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t,n,c,a,i;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_t("/friend-request",{receiverId:null===b||void 0===b?void 0:b._id});case 3:return t=e.sent,n=t.message,c=t.friendRequestDb,l.b.success(n,{autoClose:1e3}),r(c),u("sender"),null===p||void 0===p||p.emit("changeFriendRequest",{friendId:null===b||void 0===b?void 0:b._id,friendRequest:c,status:"receiver"}),e.next=11,_t("/notification",{link:"/profile/".concat(null===d||void 0===d?void 0:d._id),receiverId:null===b||void 0===b?void 0:b._id,text:(null===d||void 0===d?void 0:d.userName)+" sent a friend request",senderId:null===d||void 0===d?void 0:d._id});case 11:a=e.sent,i=a.notification,null===p||void 0===p||p.emit("createNotification",{notification:i}),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.log("err",e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n){e.next=11;break}return e.next=4,It("/friend-request/".concat(null===n||void 0===n?void 0:n._id));case 4:t=e.sent,t.message,r(),u(""),null===p||void 0===p||p.emit("changeFriendRequest",{friendId:null===b||void 0===b?void 0:b._id,status:""}),e.next=12;break;case 11:l.b.error("An error occurred while making this request!!!",{autoClose:1e3});case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log("err",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t,c;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n){e.next=12;break}return e.next=4,Ct("/friend-request/refuse-request",{friendRequestId:null===n||void 0===n?void 0:n._id});case 4:t=e.sent,c=t.message,l.b.success(c,{autoClose:1e3}),r(),u(""),null===p||void 0===p||p.emit("changeFriendRequest",{friendId:null===b||void 0===b?void 0:b._id,status:""}),e.next=13;break;case 12:l.b.error("An error occurred while making this request!!!",{autoClose:1e3});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.log("err",e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t,c,a,i;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n){e.next=18;break}return e.next=4,Ct("/friend-request/accept-friend-request",{friendId:null===b||void 0===b?void 0:b._id,friendRequestId:null===n||void 0===n?void 0:n._id});case 4:return t=e.sent,c=t.message,l.b.success(c,{autoClose:1e3}),r(),u("friend"),g({type:U,payload:null===b||void 0===b?void 0:b._id}),g({type:Ye,payload:!0}),e.next=13,_t("/notification",{link:"/profile/".concat(null===d||void 0===d?void 0:d._id),receiverId:null===b||void 0===b?void 0:b._id,text:(null===d||void 0===d?void 0:d.userName)+" has accept friend request",senderId:null===d||void 0===d?void 0:d._id});case 13:a=e.sent,i=a.notification,null===p||void 0===p||p.emit("acceptFriendRequest",{friendId:null===b||void 0===b?void 0:b._id,userId:null===d||void 0===d?void 0:d._id,notification:i}),e.next=19;break;case 18:l.b.error("An error occurred while making this request!!!",{autoClose:1e3});case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),console.log("err",e.t0);case 24:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t,c;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n||"friend"!==o){e.next=13;break}return e.next=4,Ct("/friend-request/unfriend",{friendId:null===b||void 0===b?void 0:b._id});case 4:t=e.sent,c=t.message,l.b.success(c,{autoClose:1e3}),u(""),g({type:M,payload:null===b||void 0===b?void 0:b._id}),g({type:Ye,payload:!1}),null===p||void 0===p||p.emit("removeFriend",{friendId:null===b||void 0===b?void 0:b._id,userId:null===d||void 0===d?void 0:d._id}),e.next=14;break;case 13:l.b.error("An error occurred while making this request!!!",{autoClose:1e3});case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.log("err",e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}();return Object(et.jsxs)(et.Fragment,{children:[o?"friend"===o?Object(et.jsxs)(et.Fragment,{children:[Object(et.jsx)("button",{className:"card__action__button card__action--friend",children:"friend"}),Object(et.jsx)("button",{"data-toggle":"modal","data-target":"#".concat(x.current),className:"card__action__button card__action--unfriend",children:"Unfriend"})]}):Object(et.jsx)(et.Fragment,{children:"sender"===o?Object(et.jsx)(et.Fragment,{children:Object(et.jsx)("button",{"data-toggle":"modal","data-target":"#".concat(h.current),className:"card__action__button card__action--deleteRequestFriend",children:"Cancel friend request"})}):Object(et.jsxs)(et.Fragment,{children:[Object(et.jsx)("button",{className:"card__action__button card__action--acceptFriendRequset",onClick:k,children:"Accept friend request"}),Object(et.jsx)("button",{className:"card__action__button card__action--refuseFriendRequset",onClick:C,children:"Refuse friend request"})]})}):Object(et.jsx)(et.Fragment,{children:Object(et.jsx)("button",{className:"card__action__button card__action--addFriend",onClick:y,children:"add friend"})}),Object(et.jsx)(Tn,{id:h.current,text:"Are you sure you want to cancel this friend request?",onRemove:_}),Object(et.jsx)(Tn,{id:x.current,text:"You definitely want to unfriend ".concat(null===b||void 0===b?void 0:b.userName),onRemove:I})]})},Ln=function(){var e=Object(c.useState)(!1),t=Object(O.a)(e,2),n=t[0],r=t[1],a=Object(s.c)((function(e){return e.profile})),i=a.userProfile,o=a.isFriend,l=Object(s.c)((function(e){return e.chat})),u=l.listConversation,d=l.isChat,j=l.conversationChat;Object(c.useEffect)((function(){n&&d&&u&&b()}),[d,u,n]);var b=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t,n;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,yt("conversation?receiverId=".concat(null===i||void 0===i?void 0:i._id,"&isFriend=").concat(!!o));case 5:if(t=e.sent,t.message,(null===(n=t.conversation)||void 0===n?void 0:n._id)!==(null===j||void 0===j?void 0:j._id)){e.next=9;break}return e.abrupt("return");case 9:null!==u&&void 0!==u&&u.find((function(e){return(null===e||void 0===e?void 0:e._id)===(null===n||void 0===n?void 0:n._id)}))||m({type:ae,payload:{conversation:n}}),m({type:ue,payload:{conversationChat:n}}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),console.log("err",e.t0);case 16:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}(),m=Object(s.b)();return Object(et.jsx)("button",{className:"card__action__button card__action--message messSkip",onClick:function(){r(!0),m({type:$,payload:{isChat:!0}})},children:"message"})},Pn=(n(662),function(){var e=Object(s.c)((function(e){return e.profile})).isMe;return Object(et.jsx)(et.Fragment,{children:e?Object(et.jsx)(et.Fragment,{}):Object(et.jsxs)("div",{className:"card-profile__action",children:[Object(et.jsx)(Fn,{}),Object(et.jsx)(Rn,{}),Object(et.jsx)(Ln,{})]})})}),Dn=function(){var e=Object(c.useState)("friends"),t=Object(O.a)(e,2),n=t[0],r=t[1];return Object(et.jsxs)("div",{className:"right col-lg-8",children:[Object(et.jsx)(Pn,{}),Object(et.jsx)(Sn,{option:n,setOption:r}),Object(et.jsxs)("div",{className:"display-content",children:["about"===n&&Object(et.jsx)(wn,{}),"friends"===n&&Object(et.jsx)(An,{})]})]})};n(663);function Un(e){var t=e.err;return t?Object(et.jsx)("span",{className:"mes-err",children:t}):""}var Mn=function(e){for(var t=e.split(" ").filter((function(e){return e})),n=t.length,c=[],r=[],a=[],i=0;i<n;i++)c[i]=!1;!function e(i){for(var s=0;s<n;s++)c[s]||(c[s]=!0,r[i]=t[s],i===n-1&&a.push(r.join(" ")),e(i+1),c[s]=!1)}(0);var s=a.reduce((function(e,t){var n=function(e){var t=[],n="";return e.split("").forEach((function(e){n+=e,t.push(n)})),t}(t);return[].concat(Object(bt.a)(e),Object(bt.a)(n))}),[]);return s},qn=(n(664),{userName:"",password:"",passwordAgain:"",email:""});function Bn(){var e=Object(c.useState)(Object(b.a)({},qn)),t=Object(O.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(Object(b.a)({},qn)),i=Object(O.a)(a,2),u=i[0],j=i[1],f=Object(s.c)((function(e){return e.auth})).isLoading,v=Object(s.b)(),m=function(e){var t=e.target,c=t.name,a=t.value;r(Object(b.a)(Object(b.a)({},n),{},Object(Lt.a)({},c,a))),j(Object(b.a)(Object(b.a)({},u),{},Object(Lt.a)({},c,"")))},p=Object(d.m)();return Object(et.jsx)("div",{className:"register",children:Object(et.jsxs)("div",{className:"registerWrapper",children:[Object(et.jsxs)("div",{className:"registerLeft",children:[Object(et.jsx)("h3",{className:"registerLogo",children:"CoderNoob"}),Object(et.jsx)("span",{className:"registerDesc",children:"Connect with friends and the world around you on CoderNoob."})]}),Object(et.jsx)("div",{className:"registerRight",children:Object(et.jsxs)("form",{className:"registerBox",onSubmit:function(e){e.preventDefault();var t,c=!0,r=Object(b.a)({},u);if(Xt(n.email)||(c=!1,r.email="Please enter the correct email format"),(t=en(n.userName,"User name",6))&&(c=!1,r.userName=t),(t=en(n.password,"Password",6))&&(c=!1,r.password=t),n.password!==n.passwordAgain&&(r.passwordAgain="Passwords do not match",c=!1),!c)return j(r),void l.b.warn("Please check registration information again",{autoClose:500});n.keys=Mn(n.userName),v(Ft(n,p))},children:[Object(et.jsx)("input",{required:!0,minLength:"6",maxLength:"20",name:"userName",value:n.userName,onChange:m,placeholder:"Username",className:"registerInput"}),Object(et.jsx)(Un,{err:u.userName}),Object(et.jsx)("input",{required:!0,name:"email",value:n.email,onChange:m,placeholder:"Email",type:"email",className:"registerInput"}),Object(et.jsx)(Un,{err:u.email}),Object(et.jsx)("input",{type:"password",minLength:"6",required:!0,name:"password",value:n.password,onChange:m,placeholder:"Password",className:"registerInput"}),Object(et.jsx)(Un,{err:u.password}),Object(et.jsx)("input",{type:"password",minLength:"6",required:!0,name:"passwordAgain",value:n.passwordAgain,onChange:m,placeholder:"Password Again",className:"registerInput"}),Object(et.jsx)(Un,{err:u.passwordAgain}),Object(et.jsx)("button",{className:"registerButton",children:f?Object(et.jsx)(Rt.a,{color:"primary"}):"Register"}),Object(et.jsx)(o.b,{to:"/login",style:{display:"flex",justifyContent:"center"},children:Object(et.jsx)("button",{className:"redirectButton",children:f?Object(et.jsx)(Rt.a,{color:"primary"}):"Log into Account"})})]})})]})})}n(665);var Vn=function(){return Object(et.jsxs)("div",{className:"pageNotFound",children:[Object(et.jsx)("h1",{children:"404 Error Page"}),Object(et.jsx)("p",{className:"zoom-area",children:Object(et.jsx)("b",{children:"Page Not Found"})}),Object(et.jsxs)("section",{className:"error-container",children:[Object(et.jsx)("span",{className:"four",children:Object(et.jsx)("span",{className:"screen-reader-text",children:"4"})}),Object(et.jsx)("span",{className:"zero",children:Object(et.jsx)("span",{className:"screen-reader-text",children:"0"})}),Object(et.jsx)("span",{className:"four",children:Object(et.jsx)("span",{className:"screen-reader-text",children:"4"})})]}),Object(et.jsx)("div",{className:"link-container",children:Object(et.jsx)(o.b,{to:"/",className:"more-link",children:"Visit page Home"})})]})},Qn=n(720),Gn=n(721),Hn=n(722),Jn=n(723),Kn=n(724),Yn=n(725),Wn=n(726),Zn=n(727);n(666);function zn(e){var t,n=e.user;return Object(et.jsx)(o.b,{to:"/profile/"+(null===n||void 0===n?void 0:n._id),style:{textDecoration:"none",color:"#333"},children:Object(et.jsxs)("li",{className:"sidebarFriend",children:[Object(et.jsx)("img",{className:"sidebarFriendImg",src:(null===n||void 0===n||null===(t=n.profilePicture)||void 0===t?void 0:t.length)&&(null===n||void 0===n?void 0:n.profilePicture[0])||x+"no-avatar.png",alt:""}),Object(et.jsx)("span",{className:"sidebarFriendName",children:n.userName})]})})}n(667);function Xn(){var e=Object(c.useState)([]),t=Object(O.a)(e,2),n=t[0],r=t[1],a=Object(s.c)((function(e){return e.auth})).userCurrent,i=Object(s.b)();return Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(v.a)(Object(f.a)().mark((function t(){var n,c;return Object(f.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===a||void 0===a||!a._id){t.next=12;break}return t.prev=1,t.next=4,yt("/user/get-users-suggestion/".concat(null===a||void 0===a?void 0:a._id));case 4:n=t.sent,c=n.users,e&&r(c),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("err",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){return e=!1}}),[a]),Object(et.jsx)("div",{className:"sidebar",children:Object(et.jsxs)("div",{className:"sidebarWrapper",children:[Object(et.jsxs)("ul",{className:"sidebarList",children:[Object(et.jsxs)("li",{className:"sidebarListItem",children:[Object(et.jsx)(Qn.a,{className:"sidebarIcon"}),Object(et.jsx)("span",{className:"sidebarListItemText",children:"Feed"})]}),Object(et.jsxs)("li",{className:"sidebarListItem",children:[Object(et.jsx)(Bt.a,{className:"sidebarIcon"}),Object(et.jsx)("span",{className:"sidebarListItemText",onClick:function(){return i({type:$,payload:!0})},children:"Chats"})]}),Object(et.jsxs)("li",{className:"sidebarListItem",children:[Object(et.jsx)(Gn.a,{className:"sidebarIcon"}),Object(et.jsx)("span",{className:"sidebarListItemText",children:"Videos"})]}),Object(et.jsxs)("li",{className:"sidebarListItem",children:[Object(et.jsx)(Hn.a,{className:"sidebarIcon"}),Object(et.jsx)("span",{className:"sidebarListItemText",children:"Groups"})]}),Object(et.jsxs)("li",{className:"sidebarListItem",children:[Object(et.jsx)(Jn.a,{className:"sidebarIcon"}),Object(et.jsx)("span",{className:"sidebarListItemText",children:"Bookmarks"})]}),Object(et.jsxs)("li",{className:"sidebarListItem",children:[Object(et.jsx)(Kn.a,{className:"sidebarIcon"}),Object(et.jsx)("span",{className:"sidebarListItemText",children:"Questions"})]}),Object(et.jsxs)("li",{className:"sidebarListItem",children:[Object(et.jsx)(Yn.a,{className:"sidebarIcon"}),Object(et.jsx)("span",{className:"sidebarListItemText",children:"Jobs"})]}),Object(et.jsxs)("li",{className:"sidebarListItem",children:[Object(et.jsx)(Wn.a,{className:"sidebarIcon"}),Object(et.jsx)("span",{className:"sidebarListItemText",children:"Events"})]}),Object(et.jsxs)("li",{className:"sidebarListItem",children:[Object(et.jsx)(Zn.a,{className:"sidebarIcon"}),Object(et.jsx)("span",{className:"sidebarListItemText",children:"Courses"})]})]}),Object(et.jsx)("button",{className:"sidebarButton",children:"Show More"}),Object(et.jsx)("hr",{className:"sidebarHr"}),Object(et.jsxs)("ul",{className:"sidebarUsersSuggestion",children:[Object(et.jsx)("h4",{className:"sidebarDesc",children:"Recommend friends"}),n.map((function(e){return Object(et.jsx)(zn,{user:e},null===e||void 0===e?void 0:e._id)}))]})]})})}var $n=function(e){var t=e.id,n=e.setIsEdit;return Object(et.jsx)(et.Fragment,{children:Object(et.jsxs)("div",{className:"commentCrudAction",children:[Object(et.jsx)("button",{className:"updateComment",onClick:function(){return n((function(e){return!e}))},children:"Edit"}),Object(et.jsx)("button",{type:"button",className:"removeComment","data-toggle":"modal","data-target":"#"+t,children:"Remove"})]})})},ec=(n(668),function(e){var t=e.post,n=e.user,r=e.comment,a=e.isEdit,i=e.setIsEdit,o=e.setMessages,u=Object(c.useState)([]),d=Object(O.a)(u,2),j=d[0],b=d[1],m=Object(c.useState)((null===r||void 0===r?void 0:r.text)||""),p=Object(O.a)(m,2),h=p[0],x=p[1],g=Object(c.useState)([]),y=Object(O.a)(g,2),_=y[0],C=y[1],k=Object(s.c)((function(e){return e.network})).socket,I=Object(s.c)((function(e){return e.auth})).userCurrent;Object(c.useEffect)((function(){b(null===r||void 0===r?void 0:r.images)}),[null===r||void 0===r?void 0:r.images]);var w=function(e){b(null===e||void 0===e?void 0:e.images),x((null===e||void 0===e?void 0:e.text)||""),C([]),i(!1)},E=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var n,c,a,i,s,u;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=j?Object(bt.a)(j):[],(c=null===r||void 0===r?void 0:r.images.filter((function(e){return!n.find((function(t){return e.url===t.url}))}))).length&&st(c.map((function(e){return e.public_id}))),e.next=6,it(_);case 6:return a=e.sent,n=[].concat(Object(bt.a)(n),Object(bt.a)(a)),e.next=10,Ct("/comment/update-comment/".concat(null===r||void 0===r?void 0:r._id),{text:h,images:n,userId:null===I||void 0===I?void 0:I._id,isEdit:!0});case 10:i=e.sent,s=i.message,u=i.newComment,l.b.success(s,{autoClose:2e3}),null===k||void 0===k||k.emit("commentPostHandler",{type:"update",comment:u,postId:null===t||void 0===t?void 0:t._id,userPost:t.userId,message:(null===I||void 0===I?void 0:I.userName)+"updated comment on your post"}),o((function(e){return e.map((function(e){return e._id===u._id?u:e}))})),w(u),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.log("err",e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(){return e.apply(this,arguments)}}();return Object(et.jsx)("div",{className:"commentInfo ".concat(a&&"edit"),children:a?Object(et.jsxs)(et.Fragment,{children:[Object(et.jsxs)("div",{className:"editCommentContainer",children:[Object(et.jsx)("input",{className:"editCommentInput",type:"text",autoFocus:!0,value:h,onChange:function(e){return x(e.target.value)}}),Object(et.jsx)("button",{onClick:function(){return w()},type:"button",className:"btn btn-secondary  btnEdit btnCancelEdit ",children:"Cancel"}),Object(et.jsx)("button",{type:"button",className:"btn btn-success btnEdit btnConfirmEdit",onClick:E,children:"Edit"})]}),Object(et.jsxs)("div",{className:"editImgPost",children:[Object(et.jsx)("div",{className:"editImgPostTop",children:Object(et.jsxs)("div",{className:"shareOption",children:[Object(et.jsx)(Pt.a,{htmlColor:"tomato",className:"shareIcon"}),Object(et.jsx)("span",{className:"shareOptionText",children:"Posted photo"})]})}),Object(et.jsx)("div",{className:"disPlayImgCreateComment",children:j&&j.map((function(e){return Object(et.jsx)("div",{className:"imgContainer",children:Object(et.jsx)(Ut,{image:e.url,setImages:b})},e.url)}))}),Object(et.jsxs)("div",{className:"editImgPostTop",children:[Object(et.jsxs)("label",{htmlFor:"editEomment"+r._id,className:"shareOption",children:[Object(et.jsx)(Pt.a,{htmlColor:"tomato",className:"shareIcon"}),Object(et.jsx)("span",{className:"shareOptionText",children:"Add Photo or Video"})]}),Object(et.jsx)("input",{style:{display:" none"},type:"file",id:"editEomment"+r._id,accept:".png,.jpeg,.jpg",multiple:!0,onChange:function(e){var t=Array.from(e.target.files);C((function(e){return[].concat(Object(bt.a)(e),Object(bt.a)(t.map((function(e){return e.uuid=Object(N.a)(),e}))))}))}})]}),Object(et.jsx)("div",{className:"disPlayImgCreateComment",children:_.map((function(e){return Object(et.jsx)("div",{className:"imgContainer",children:Object(et.jsx)(Ut,{file:e,setFiles:C})},e.uuid)}))})]})]}):Object(et.jsxs)(et.Fragment,{children:[Object(et.jsxs)("div",{className:"commentInfoTop",children:[Object(et.jsx)("span",{className:"commentUserName",children:null===n||void 0===n?void 0:n.userName}),Object(et.jsx)("span",{className:"commentText",children:null===r||void 0===r?void 0:r.text})]}),Object(et.jsx)("div",{className:"commentInfoImgContainer",children:r.images.map((function(e,t){return Object(et.jsx)("img",{alt:"link anh",className:"commentInfoImg",style:{width:"".concat(r.images.length%2!==0&&t===r.images.length-1?"100%":"calc(100%/2)")},src:e&&e.url},e.url)}))})]})})});n(669);var tc=function(e){var t=e.comment,n=e.commentReply,r=e.setCommentsReply,a=Object(c.useState)(),i=Object(O.a)(a,2),o=i[0],u=i[1],d=Object(c.useState)({}),j=Object(O.a)(d,2),b=(j[0],j[1]),m=Object(c.useState)(!1),p=Object(O.a)(m,2),h=p[0],x=p[1],g=Object(c.useState)(!1),N=Object(O.a)(g,2),y=N[0],_=N[1],C=Object(s.c)((function(e){return e.auth})).userCurrent,k=Object(c.useState)(!1),I=Object(O.a)(k,2),w=I[0],E=I[1];Object(c.useEffect)((function(){u(null===n||void 0===n?void 0:n.likes.length),E(null===n||void 0===n?void 0:n.likes.includes(C._id))}),[null===n||void 0===n?void 0:n.likes,null===C||void 0===C?void 0:C._id]),Object(c.useEffect)((function(){var e=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t,c;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,yt("/user?userId=".concat(null===n||void 0===n?void 0:n.userId));case 3:t=e.sent,c=t.user,b(c),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("err",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[n]),Object(c.useEffect)((function(){var e=function(e){h&&x(!1)};return document.body.addEventListener("click",e),function(){return document.body.removeEventListener("click",e)}}),[h]);var A=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t,c;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!w){e.next=7;break}return e.next=4,Ct("/comment/unlike-comment/".concat(n._id),{userId:C._id});case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,Ct("/comment/like-comment/".concat(n._id),{userId:C._id});case 9:e.t0=e.sent;case 10:t=e.t0,c=t.message,l.b.success(c,{autoClose:1e3}),e.next=18;break;case 15:e.prev=15,e.t1=e.catch(0),console.log("err",e.t1);case 18:E(!w),u(w?o-1:o+1);case 20:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var c,a;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,It("/comment/remove-comment-reply/".concat(t._id,"/").concat(n._id,"/").concat(C._id));case 3:c=e.sent,a=c.message,l.b.success(a,{autoClose:1e3}),r((function(e){return e.filter((function(e){return e._id!==n._id}))})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("err",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return Object(et.jsx)(et.Fragment,{children:Object(et.jsxs)("div",{className:"commentReplyContainer",children:[Object(et.jsx)("div",{className:"commentReplyLeft",children:Object(et.jsx)(lt,{user:C})}),Object(et.jsxs)("div",{className:"commentReplyRight",children:[Object(et.jsxs)("div",{className:"commentReplyRightTop",children:[Object(et.jsx)(ec,{user:C,comment:n,isEdit:y,setIsEdit:_,setMessages:r}),(null===n||void 0===n?void 0:n.userId)===C._id&&Object(et.jsxs)("div",{className:"commentCrud",onClick:function(){return x(!h)},children:[Object(et.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAHVJREFUSEtjZKAxYKSx+QyjFhAM4dEgGqFB5MDAwDAf6vdEBgaGA1A2qeJgbdhS0QMGBgZ5qKEgtiISmxRxnBZ8YGBg4Ica+pCBgUEByiZVHKcFoKBYADU0AS2ISBHHaQHBpEeKgtGcTDC0RoNoNIgIhgBBBQBNkxgZxgF3rgAAAABJRU5ErkJggg=="}),h&&Object(et.jsx)($n,{id:n._id,onRemoveComment:S,setIsEdit:_})]})]}),Object(et.jsxs)("div",{className:"commentReplyAction",children:[Object(et.jsxs)("div",{className:"commentReplyLikeContainer",children:[Object(et.jsx)("span",{className:"commentReplyLike ".concat(w&&"like"),onClick:A,children:"Like"}),Object(et.jsx)("span",{className:"commentReplyNumberLike",children:o})]}),Object(et.jsx)("span",{className:"commentRefDate",children:ze.a(null===n||void 0===n?void 0:n.createdAt)}),n.isEdit&&Object(et.jsx)("span",{className:"showIsEdit",children:"Edited"})]})]}),Object(et.jsx)(Tn,{id:null===n||void 0===n?void 0:n._id,onRemove:S,text:"this comment ?"})]})})},nc=(n(670),function(e){var t=e.onCreateComment,n=e.user,r=e.setFiles,a=e.files,i=e.id,s=Object(c.useRef)();return Object(et.jsx)(et.Fragment,{children:Object(et.jsxs)("form",{className:"createComment",onSubmit:function(e){t(e,s.current.value),s.current.value=""},children:[Object(et.jsxs)("div",{className:"createCommentInput",children:[Object(et.jsx)(lt,{width:"50px",height:"50px",user:n}),Object(et.jsxs)("div",{className:"createCommentInputTop",children:[Object(et.jsx)("input",{autoFocus:!0,type:"text",ref:s,placeholder:"Enter comment..."}),Object(et.jsx)("label",{htmlFor:"filesCreateComment"+i,className:"shareOption",children:Object(et.jsx)(Pt.a,{htmlColor:"tomato",className:"shareIcon"})}),Object(et.jsx)("input",{style:{display:" none"},type:"file",id:"filesCreateComment"+i,accept:".png,.jpeg,.jpg",multiple:!0,onChange:function(e){var t=Array.from(e.target.files);r(Object(bt.a)(t.map((function(e){return e.uuid=Object(N.a)(),e}))))}})]}),Object(et.jsx)("button",{type:"submit",className:"btn btn-primary btnCreateComment",children:"Send"})]}),Object(et.jsx)("div",{className:"disPlayImgCreateComment",children:a.map((function(e){return Object(et.jsx)("div",{className:"imgContainer",children:Object(et.jsx)(Ut,{file:e,setFiles:r})},e.uuid)}))})]})})});n(671);var cc=function(e){var t=e.comment,n=e.post,r=e.setComments,a=Object(c.useState)(),i=Object(O.a)(a,2),o=i[0],u=i[1],d=Object(c.useState)({}),j=Object(O.a)(d,2),b=j[0],m=j[1],p=Object(c.useState)(!1),h=Object(O.a)(p,2),x=h[0],g=h[1],y=Object(c.useState)(!1),_=Object(O.a)(y,2),C=_[0],k=_[1],I=Object(c.useState)([]),w=Object(O.a)(I,2),E=w[0],A=w[1],S=Object(c.useState)(!1),R=Object(O.a)(S,2),T=R[0],F=R[1],L=Object(c.useState)([]),P=Object(O.a)(L,2),D=P[0],U=P[1],M=Object(c.useState)(!1),q=Object(O.a)(M,2),B=q[0],V=q[1],Q=Object(s.c)((function(e){return e.network})).socket,G=Object(s.c)((function(e){return e.auth})).userCurrent,H=Object(s.c)((function(e){return e.comment})).idComment,J=Object(c.useRef)(Object(N.a)());Object(c.useEffect)((function(){var e=function(e){T&&F(!1)};return document.body.addEventListener("click",e),function(){return document.body.removeEventListener("click",e)}}),[T]),Object(c.useEffect)((function(){u(null===t||void 0===t?void 0:t.likes.length),V(null===t||void 0===t?void 0:t.likes.includes(G._id))}),[null===t||void 0===t?void 0:t.likes,null===G||void 0===G?void 0:G._id]);var K=Object(s.b)();Object(c.useEffect)((function(){var e=!0,n=function(){var n=Object(v.a)(Object(f.a)().mark((function n(){var c,r;return Object(f.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,yt("/user?userId=".concat(null===t||void 0===t?void 0:t.userId));case 3:c=n.sent,r=c.user,e&&m(r),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log("err",n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}();return n(),function(){return e=!1}}),[t]),Object(c.useEffect)((function(){var e=!0,n=function(){var n=Object(v.a)(Object(f.a)().mark((function n(){var c,r;return Object(f.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,yt("/comment/get-all-comments-reply/".concat(null===t||void 0===t?void 0:t._id));case 3:c=n.sent,c.message,r=c.comments,e&&A(r),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log("err",n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}();return x&&n(),function(){return e=!1}}),[x]);var Y=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var n,c;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!B){e.next=7;break}return e.next=4,Ct("/comment/unlike-comment/".concat(t._id),{userId:G._id});case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,Ct("/comment/like-comment/".concat(t._id),{userId:G._id});case 9:e.t0=e.sent;case 10:n=e.t0,c=n.message,l.b.success(c,{autoClose:1e3}),e.next=18;break;case 15:e.prev=15,e.t1=e.catch(0),console.log("err",e.t1);case 18:V(!B),u(B?o-1:o+1);case 20:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(v.a)(Object(f.a)().mark((function e(c,r){var a,i,s,o,u;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.preventDefault(),e.prev=1,r||D.length){e.next=4;break}return e.abrupt("return",l.b.info("Please enter data to comment",{autoClose:2e3}));case 4:return a={postId:null===n||void 0===n?void 0:n._id,userId:null===b||void 0===b?void 0:b._id,text:r},e.next=7,it(D);case 7:return i=e.sent,a.images=Object(bt.a)(i),e.next=11,_t("/comment",a);case 11:return s=e.sent,o=s.comment,u=s.message,e.next=15,_t("/comment/add-comment-reply/".concat(null===t||void 0===t?void 0:t._id),{commentReplyId:o._id});case 15:e.sent,x&&A((function(e){return[o].concat(Object(bt.a)(e))})),U([]),g(!0),l.b.success(u,{autoClose:2e3}),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(1),console.log("err",e.t0);case 25:case"end":return e.stop()}}),e,null,[[1,22]])})));return function(t,n){return e.apply(this,arguments)}}(),Z=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var c,a;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_t("/post/remove-comment/".concat(null===n||void 0===n?void 0:n._id),{commentId:null===t||void 0===t?void 0:t._id,userId:null===G||void 0===G?void 0:G._id});case 3:c=e.sent,a=c.message,l.b.success(a,{autoClose:2e3}),r((function(e){return e.filter((function(e){return e._id!==t._id}))})),null===Q||void 0===Q||Q.emit("commentPostHandler",{type:"remove",comment:t,postId:null===n||void 0===n?void 0:n._id,userPost:n.userId,message:(null===G||void 0===G?void 0:G.userName)+" deleted the comment on your post"}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("err",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return Object(et.jsxs)(et.Fragment,{children:[Object(et.jsx)("div",{className:"commentLeft",children:Object(et.jsx)(lt,{user:b})}),Object(et.jsxs)("div",{className:"commentRight",children:[Object(et.jsxs)("div",{className:"commentRightTop",children:[Object(et.jsx)(ec,{post:n,user:b,comment:t,isEdit:C,setIsEdit:k,setMessages:r}),(null===t||void 0===t?void 0:t.userId)===(null===G||void 0===G?void 0:G._id)&&Object(et.jsxs)("div",{className:"commentCrud",onClick:function(){return F(!T)},children:[Object(et.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAHVJREFUSEtjZKAxYKSx+QyjFhAM4dEgGqFB5MDAwDAf6vdEBgaGA1A2qeJgbdhS0QMGBgZ5qKEgtiISmxRxnBZ8YGBg4Ica+pCBgUEByiZVHKcFoKBYADU0AS2ISBHHaQHBpEeKgtGcTDC0RoNoNIgIhgBBBQBNkxgZxgF3rgAAAABJRU5ErkJggg=="}),T&&Object(et.jsx)($n,{id:null===t||void 0===t?void 0:t._id,onRemoveComment:Z,setIsEdit:k})]})]}),Object(et.jsxs)("div",{className:"commentAction",children:[Object(et.jsxs)("div",{className:"commentLikeContainer",children:[Object(et.jsx)("span",{className:"commentLike ".concat(B&&"like"),onClick:Y,children:"Like"}),Object(et.jsx)("span",{className:"commentNumberLike",children:o})]}),Object(et.jsx)("span",{className:"reply",onClick:function(){var e=null===t||void 0===t?void 0:t._id;H===(null===t||void 0===t?void 0:t._id)&&(e=null),K({type:de,payload:{idComment:e}})},children:"Reply"}),Object(et.jsx)("span",{className:"commentDate",children:ze.a(null===t||void 0===t?void 0:t.createdAt)}),Object(et.jsx)("span",{className:"showFeedback",onClick:function(){return g(!x)},children:"feedbacks"}),t.isEdit&&Object(et.jsx)("span",{className:"showIsEdit",children:"Edited"})]}),Object(et.jsxs)("div",{className:"comentBottom",children:[H===(null===t||void 0===t?void 0:t._id)&&Object(et.jsx)(nc,{id:J.current,files:D,setFiles:U,user:G,onCreateComment:W}),x&&E.map((function(e){return Object(et.jsx)(tc,{comment:t,setCommentsReply:A,commentReply:e},null===e||void 0===e?void 0:e._id)}))]}),Object(et.jsx)(Tn,{text:"this comment ?",id:null===t||void 0===t?void 0:t._id,onRemove:Z})]})]})},rc=(n(672),n(733)),ac=n(735),ic=function(e){var t=e.setPosts,n=e.post,r=e.setIsEdit,a=Object(c.useState)(null===n||void 0===n?void 0:n.images),i=Object(O.a)(a,2),o=i[0],u=i[1],d=Object(c.useState)((null===n||void 0===n?void 0:n.desc)||""),j=Object(O.a)(d,2),b=j[0],m=j[1],p=Object(c.useState)([]),h=Object(O.a)(p,2),x=h[0],g=h[1],y=Object(c.useState)(!1),_=Object(O.a)(y,2),C=_[0],k=_[1],I=Object(c.useRef)(Object(N.a)()),w=Object(s.c)((function(e){return e.network})).socket,E=Object(s.c)((function(e){return e.auth})).userCurrent,A=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var c,r,a,i,s,u;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=Object(bt.a)(o),(r=null===n||void 0===n?void 0:n.images.filter((function(e){return!c.find((function(t){return e.url===t.url}))}))).length&&st(r.map((function(e){return e.public_id}))),e.next=6,it(x);case 6:return a=e.sent,c=[].concat(Object(bt.a)(c),Object(bt.a)(a)),e.next=10,Ct("/post/".concat(null===n||void 0===n?void 0:n._id),{desc:b,images:c,userId:E._id});case 10:i=e.sent,s=i.message,u=i.newPost,l.b.success(s,{autoClose:2e3}),t((function(e){return e.map((function(e){return e._id===u._id?u:e}))})),null===w||void 0===w||w.emit("postHandler",{type:"updatePost",post:u,userFollowings:null===E||void 0===E?void 0:E.followings,message:"".concat(null===E||void 0===E?void 0:E.userName," just edit a new post")}),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),console.log("err",e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(){return e.apply(this,arguments)}}(),S=function(){u(null===n||void 0===n?void 0:n.images),m((null===n||void 0===n?void 0:n.desc)||""),g([]),r(!1)};return Object(et.jsx)(et.Fragment,{children:Object(et.jsxs)(rc.a,{show:!0,onHide:S,className:"modalEditContainer",children:[Object(et.jsx)(rc.a.Header,{closeButton:!0,children:Object(et.jsx)(rc.a.Title,{children:"Edit Post"})}),Object(et.jsxs)(rc.a.Body,{className:"modalEditPostBody",children:[Object(et.jsx)("div",{className:"editDescPost",children:Object(et.jsx)("textarea",{className:"editDescPostInput",value:b,onChange:function(e){return m(e.target.value)},autoFocus:!0,row:1e3})}),Object(et.jsxs)("div",{className:"editImgPost",children:[Object(et.jsx)("div",{className:"editImgPostTop",children:Object(et.jsxs)("div",{className:"shareOption",children:[Object(et.jsx)(Pt.a,{htmlColor:"tomato",className:"shareIcon"}),Object(et.jsx)("span",{className:"shareOptionText",children:"Posted photo"})]})}),Object(et.jsx)("div",{className:"disPlayImgCreateComment",children:o.map((function(e){return Object(et.jsx)("div",{className:"imgContainer",children:Object(et.jsx)(Ut,{image:e.url,setImages:u})},e.url)}))}),Object(et.jsx)(Mt,{setIsTakePhoto:k,isTakePhoto:C,files:x,id:I.current,multiple:!0,setFiles:g})]})]}),Object(et.jsxs)(rc.a.Footer,{children:[Object(et.jsx)(ac.a,{variant:"secondary",onClick:S,children:"Close"}),Object(et.jsx)(ac.a,{variant:"primary",onClick:function(){A(),S()},children:"Save Changes"})]})]})})},sc=(n(675),function(e){var t=e.id,n=e.setIsEdit,c=Object(d.m)();return Object(et.jsx)(et.Fragment,{children:Object(et.jsxs)(et.Fragment,{children:[Object(et.jsx)("button",{className:"detailPost",onClick:function(){return c("/post/"+t)},children:"Detail Post"}),Object(et.jsx)("button",{className:"updatePost",onClick:function(){return n((function(e){return!e}))},children:"Edit"}),Object(et.jsx)("button",{type:"button",className:"removePost","data-toggle":"modal","data-target":"#"+t,children:"Remove"})]})})});n(676);function oc(e){var t=e.post,n=e.setPosts,r=e.className,a=Object(c.useState)(null===t||void 0===t?void 0:t.likes.length),i=Object(O.a)(a,2),o=i[0],u=i[1],d=Object(c.useState)(!1),j=Object(O.a)(d,2),b=j[0],m=j[1],p=Object(c.useState)({}),h=Object(O.a)(p,2),x=h[0],g=h[1],y=Object(c.useState)([]),_=Object(O.a)(y,2),C=_[0],k=_[1],I=Object(c.useState)(!1),w=Object(O.a)(I,2),E=w[0],A=w[1],S=Object(c.useState)(!1),R=Object(O.a)(S,2),T=R[0],F=R[1],L=Object(c.useState)(!1),P=Object(O.a)(L,2),D=P[0],U=P[1],M=Object(c.useState)([]),q=Object(O.a)(M,2),B=q[0],V=q[1],Q=Object(s.c)((function(e){return e.network})).socket,G=Object(s.c)((function(e){return e.auth})).userCurrent,H=Object(s.c)((function(e){return e.comment})),J=H.idComment,K=H.idPostOpen,Y=Object(c.useRef)(Object(N.a)()),W=Object(s.b)();Object(c.useEffect)((function(){var e=function(e){T&&F(!1)};return document.body.addEventListener("click",e),function(){return document.body.removeEventListener("click",e)}}),[T]),Object(c.useEffect)((function(){m(null===t||void 0===t?void 0:t.likes.includes(null===G||void 0===G?void 0:G._id)),u(null===t||void 0===t?void 0:t.likes.length)}),[null===t||void 0===t?void 0:t.likes,null===G||void 0===G?void 0:G._id]),Object(c.useEffect)((function(){var e=!0,n=function(){var n=Object(v.a)(Object(f.a)().mark((function n(){var c,r;return Object(f.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,yt("/post/get-all-comment/".concat(null===t||void 0===t?void 0:t._id));case 3:c=n.sent,r=c.comments,e&&k(r),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log("err",n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}();return E&&n(),function(){return e=!1}}),[E,null===t||void 0===t?void 0:t.comments]),Object(c.useEffect)((function(){var e=!0;if((null===G||void 0===G?void 0:G._id)!==(null===t||void 0===t?void 0:t.userId)){var n=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var n,c;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,yt("/user?userId=".concat(null===t||void 0===t?void 0:t.userId));case 3:n=e.sent,c=n.user,g(c),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("err",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();n()}else e&&g(G);return function(){return e=!1}}),[G,null===t||void 0===t?void 0:t.userId]),Object(c.useEffect)((function(){var e=function(e){var n=e.type,c=(e.message,e.postId);(null===t||void 0===t?void 0:t._id)===c&&u((function(e){return"like"===n?e+1:e-1}))},n=function(e){var n=e.postId,c=e.type,r=e.comment;(null===t||void 0===t?void 0:t._id)===n&&k((function(e){return"remove"===c?e.filter((function(e){return(null===e||void 0===e?void 0:e._id)!==(null===r||void 0===r?void 0:r._id)})):"update"===c?e.map((function(e){return(null===e||void 0===e?void 0:e._id)!==(null===r||void 0===r?void 0:r._id)?e:r})):[r].concat(Object(bt.a)(e))}))};return Q&&(Q.on("updateLikePost",e),Q.on("updateCommentPost",n)),function(){null===Q||void 0===Q||Q.off("getNotify",e),null===Q||void 0===Q||Q.off("updateCommentPost",n)}}),[Q]);var Z=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var n,c,r,a;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!b){e.next=7;break}return e.next=4,Ct("/post/dislike-post/".concat(t._id),{userId:G._id});case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,Ct("/post/like-post/".concat(t._id),{userId:G._id});case 9:e.t0=e.sent;case 10:if(n=e.t0,c=n.message,l.b.success(c,{autoClose:2e3}),b||(null===t||void 0===t?void 0:t.userId)===(null===G||void 0===G?void 0:G._id)){e.next=19;break}return e.next=16,_t("/notification",{link:"/post/"+(null===t||void 0===t?void 0:t._id),receiverId:null===t||void 0===t?void 0:t.userId,text:(null===G||void 0===G?void 0:G.userName)+" liked on your post",senderId:null===G||void 0===G?void 0:G._id});case 16:r=e.sent,a=r.notification,null===Q||void 0===Q||Q.emit("createNotification",{notification:a});case 19:m((function(e){return!e})),u((function(e){return b?e-1:e+1})),e.next=26;break;case 23:e.prev=23,e.t1=e.catch(0),console.log("err",e.t1);case 26:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=Object(v.a)(Object(f.a)().mark((function e(n,c){var r,a,i,s,o,u,d;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,r={postId:null===t||void 0===t?void 0:t._id,userId:null===G||void 0===G?void 0:G._id,text:c,images:[]},e.next=5,it(B);case 5:return a=e.sent,r.images=Object(bt.a)(a),e.next=9,_t("/comment",r);case 9:return i=e.sent,s=i.comment,o=i.message,e.next=13,_t("/post/add-comment/".concat(null===t||void 0===t?void 0:t._id),{commentId:null===s||void 0===s?void 0:s._id});case 13:return e.sent,l.b.success(o,{autoClose:2e3}),e.next=17,_t("/notification",{link:"/post/"+(null===t||void 0===t?void 0:t._id),receiverId:null===t||void 0===t?void 0:t.userId,text:(null===G||void 0===G?void 0:G.userName)+" commented on your post",senderId:null===G||void 0===G?void 0:G._id});case 17:u=e.sent,d=u.notification,null===Q||void 0===Q||Q.emit("createNotification",{notification:d}),k((function(e){return[s].concat(Object(bt.a)(e))})),V([]),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(1),console.log("err",e.t0);case 27:case"end":return e.stop()}}),e,null,[[1,24]])})));return function(t,n){return e.apply(this,arguments)}}(),X=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var c,r;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,It("/post/".concat(null===t||void 0===t?void 0:t._id));case 3:c=e.sent,r=c.message,l.b.success(r,{autoClose:2e3}),n((function(e){return e.filter((function(e){return e._id!==(null===t||void 0===t?void 0:t._id)}))})),Q.emit("postHandler",{type:"remove",post:t,userFollowings:null===G||void 0===G?void 0:G.followings,message:"".concat(null===G||void 0===G?void 0:G.userName," just edit a new post")}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("err",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return Object(et.jsxs)(et.Fragment,{children:[Object(et.jsxs)("div",{className:r||"post",children:[Object(et.jsxs)("div",{className:"postWrapper",children:[Object(et.jsxs)("div",{className:"postTop",children:[Object(et.jsxs)("div",{className:"postTopLeft",children:[Object(et.jsx)(lt,{user:x,width:"50px",height:"50px"}),Object(et.jsx)("span",{className:"postUsername",children:null===x||void 0===x?void 0:x.userName}),Object(et.jsx)("span",{className:"postDate",children:ze.a(null===t||void 0===t?void 0:t.createdAt)})]}),(null===t||void 0===t?void 0:t.userId)===(null===G||void 0===G?void 0:G._id)&&Object(et.jsxs)("div",{className:"postTopRight",children:[Object(et.jsx)("span",{className:"CrudPost",onClick:function(){return F(!T)},children:Object(et.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAFBJREFUSEtjZKAxYKSx+Qwjy4L/aMFJlO+JUgQ1eNQC2iRYUuKALBeQYsFoJBMMYpoHEUEXYFNASiTT3AKaB9GoBWTFIUFNgyoVEXTtgOQDAEM9DBleh0KcAAAAAElFTkSuQmCC"})}),T&&Object(et.jsx)("div",{className:"postCrudAction",children:Object(et.jsx)(sc,{id:null===t||void 0===t?void 0:t._id,setIsEdit:U})})]})]}),Object(et.jsxs)("div",{className:"postCenter",children:[Object(et.jsx)("span",{className:"postText",children:null===t||void 0===t?void 0:t.desc}),Object(et.jsx)("div",{className:"postImgContainer",children:null===t||void 0===t?void 0:t.images.map((function(e,n){return Object(et.jsx)("div",{className:"postImg",style:{width:"".concat(t.images.length%2!==0&&n===t.images.length-1?"100%":"calc(100%/2)")},children:Object(et.jsx)("img",{src:e.url,alt:""})},e.url)}))})]}),Object(et.jsxs)("div",{className:"postBottom",children:[Object(et.jsxs)("div",{className:"postBottomLeft",children:[Object(et.jsx)("i",{className:"bx ".concat(b?"bxs-heart has-like":"bx-heart"," likeIcon"),onClick:un(Z,2e3)}),Object(et.jsxs)("span",{className:"postLikeCounter",children:[o," people like it"]})]}),Object(et.jsxs)("div",{className:"postBottomRight",onClick:function(){var e=null===t||void 0===t?void 0:t._id,n=null===t||void 0===t?void 0:t._id;K===(null===t||void 0===t?void 0:t._id)&&(n=null,e=null),W({type:de,payload:{idComment:e,idPostOpen:n}}),A(!E)},children:[C.length?Object(et.jsx)("span",{className:"postCommentText",children:C.length}):"",Object(et.jsx)("i",{className:"bx bx-comment postCommentIcon"})]})]}),Object(et.jsxs)("div",{className:"commentContainer",children:[J===(null===t||void 0===t?void 0:t._id)&&Object(et.jsx)(nc,{id:Y.current,files:B,setFiles:V,user:G,onCreateComment:z}),Object(et.jsx)("div",{className:"displayComment",children:E&&C.map((function(e){return Object(et.jsx)("div",{className:"comment",children:Object(et.jsx)(cc,{setComments:k,post:t,comment:e})},e._id)}))})]})]}),D&&Object(et.jsx)(ic,{setPosts:n,setIsEdit:U,post:t})]}),Object(et.jsx)(Tn,{onRemove:X,id:null===t||void 0===t?void 0:t._id,text:"this post ?"})]})}var lc=n(728),uc=n(729),dc=n(730);n(677);function jc(e){var t=e.setPosts,n=Object(s.c)((function(e){return e.network})).socket,r=Object(s.c)((function(e){return e.auth})).userCurrent,a=Object(c.useState)(!1),i=Object(O.a)(a,2),o=i[0],u=i[1],d=Object(c.useState)([]),j=Object(O.a)(d,2),b=j[0],m=j[1],p=Object(c.useRef)(),h=Object(c.useRef)(Object(N.a)()),x=function(){var e=Object(v.a)(Object(f.a)().mark((function e(c){var a,i,s,d,j,v,O;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.preventDefault(),!o){e.next=3;break}return e.abrupt("return");case 3:if(b.length||p.current.value){e.next=5;break}return e.abrupt("return",l.b.info("Please enter information to create a post",{autoClose:1e3}));case 5:return u(!0),a={desc:p.current.value,userId:null===r||void 0===r?void 0:r._id,images:[]},e.next=9,it(b);case 9:return i=e.sent,a.images=i,e.prev=11,e.next=14,_t("/post",a);case 14:return s=e.sent,d=s.message,j=s.post,p.current.value="",l.b.success(d,{autoClose:2e3}),e.next=20,Promise.all(r.followings.map((function(e){return _t("/notification",{link:"/post/"+(null===j||void 0===j?void 0:j._id),receiverId:e,text:(null===r||void 0===r?void 0:r.userName)+" created a new post",senderId:null===r||void 0===r?void 0:r._id})})));case 20:v=e.sent,O=[],v.forEach((function(e){var t;return O.push(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.notification)})),null===n||void 0===n||n.emit("createPost",{dataEmit:O}),t((function(e){return[j].concat(Object(bt.a)(e))})),m([]),u(!1),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(11),console.log("err",e.t0);case 32:case"end":return e.stop()}}),e,null,[[11,29]])})));return function(t){return e.apply(this,arguments)}}();return Object(et.jsxs)("div",{className:"share",children:[Object(et.jsxs)("div",{className:"shareWrapper",children:[Object(et.jsxs)("div",{className:"shareTop",children:[Object(et.jsx)(lt,{user:r,width:"50px",height:"50px"}),Object(et.jsx)("input",{required:!0,placeholder:"What's in your mind ".concat(null===r||void 0===r?void 0:r.userName," ?"),className:"shareInput",ref:p})]}),Object(et.jsx)("hr",{className:"shareHr"}),Object(et.jsxs)("form",{className:"",onSubmit:x,children:[Object(et.jsxs)("div",{className:"shareBottom",children:[Object(et.jsxs)("div",{className:"shareOptions",children:[Object(et.jsxs)("button",{type:"button","data-target":"#".concat(h.current),"data-toggle":"modal",className:"shareOption",style:{border:0,outline:0,backgroundColor:"transparent"},children:[Object(et.jsx)(Pt.a,{htmlColor:"tomato",className:"shareIcon"}),Object(et.jsx)("span",{className:"shareOptionText",children:"Photo or Video"})]}),Object(et.jsxs)("div",{className:"shareOption",children:[Object(et.jsx)(lc.a,{htmlColor:"blue",className:"shareIcon"}),Object(et.jsx)("span",{className:"shareOptionText",children:"Tag"})]}),Object(et.jsxs)("div",{className:"shareOption",children:[Object(et.jsx)(uc.a,{htmlColor:"green",className:"shareIcon"}),Object(et.jsx)("span",{className:"shareOptionText",children:"Location"})]}),Object(et.jsxs)("div",{className:"shareOption",children:[Object(et.jsx)(dc.a,{htmlColor:"goldenrod",className:"shareIcon"}),Object(et.jsx)("span",{className:"shareOptionText",children:"Feelings"})]})]}),Object(et.jsx)("button",{type:"submit",className:"shareButton ".concat(o?"isShareing":""),children:"Share"})]}),Object(et.jsx)("div",{className:"shareImgContainer",children:b.map((function(e){return Object(et.jsx)("div",{className:"imgContainer",children:Object(et.jsx)(Ut,{file:e,setFiles:m})},e.uuid)}))})]})]}),Object(et.jsx)(qt,{onSave:function(e){m((function(t){return[].concat(Object(bt.a)(t),Object(bt.a)(e))}))},height:"150px",multiple:!0,id:h.current,text:"Choose a photo for the post"})]})}n(678);var bc=function(e){var t=e.postsLength,n=e.limit,r=Object(c.useRef)(null),a=Object(s.b)();return Object(c.useEffect)((function(){var e=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&a({type:Je,payload:{skip:t,limit:n+2,isLoadingPost:!0}})}))}));return e.observe(r.current),function(){r.current&&e.unobserve(r.current)}}),[]),Object(et.jsx)("div",{ref:r,children:"Get More Post"})};function fc(e){var t=e.userName,n=Object(c.useState)([]),r=Object(O.a)(n,2),a=r[0],i=r[1],o=Object(s.c)((function(e){return e.network})).socket,u=Object(s.c)((function(e){return e.post})),d=u.limit,j=u.skip,b=u.isLoadingPost,m=u.isMaxPost,p=Object(s.c)((function(e){return e.auth})).userCurrent,h=Object(s.b)();return Object(c.useEffect)((function(){var e=function(e){var t=e.post,n=e.type,c=e.message;l.b.info(c,{autoClose:2e3}),i((function(e){return"removePost"===n?e.filter((function(e){return(null===e||void 0===e?void 0:e._id)!==(null===t||void 0===t?void 0:t._id)})):"updatePost"===n?e.map((function(e){return(null===e||void 0===e?void 0:e._id)!==(null===t||void 0===t?void 0:t._id)?e:t})):[t].concat(Object(bt.a)(e))}))};return o&&o.on("updateFeed",e),function(){null===o||void 0===o||o.off("updateFeed",e)}}),[o]),Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(v.a)(Object(f.a)().mark((function t(){var n,c;return Object(f.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,yt("/post/get-feed-post?limit=".concat(d,"&skip=").concat(j));case 3:if(n=t.sent,(c=n.posts).length){t.next=8;break}return h({type:Je,payload:{isMaxPost:!0}}),t.abrupt("return");case 8:if(e){t.next=10;break}return t.abrupt("return");case 10:i([].concat(Object(bt.a)(a),Object(bt.a)(c))),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),console.log("get post feed",t.t0);case 16:return t.prev=16,h({type:Ke}),t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[0,13,16,19]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){return e=!1}}),[d,j]),Object(et.jsxs)("div",{className:"feedWrapper",children:[(!t||t===(null===p||void 0===p?void 0:p.userName))&&Object(et.jsx)(jc,{setPosts:i}),a.map((function(e){return Object(et.jsx)(oc,{setPosts:i,post:e},e._id)})),b?Object(et.jsx)("div",{className:"loadingPost",children:Object(et.jsx)(Rt.a,{color:"primary"})}):m?Object(et.jsx)(dt,{mess:"Make friends to see more posts"}):Object(et.jsx)(bc,{postsLength:a.length,limit:d})]})}var vc=n(731),Oc=n(732);n(679);function mc(e){var t=e.friend;return Object(et.jsxs)(o.b,{to:"/profile/"+(null===t||void 0===t?void 0:t._id),className:"rightbarFriend",children:[Object(et.jsx)("div",{className:"rightbarProfileImgContainer",children:Object(et.jsx)(lt,{user:t,link:!1})}),Object(et.jsx)("span",{className:"rightbarUsername",children:null===t||void 0===t?void 0:t.userName})]})}n(680);function pc(e){var t=e.user,n=Object(c.useState)([]),r=Object(O.a)(n,2),a=r[0],i=r[1],u=Object(s.c)((function(e){return e.auth})).userCurrent,d=Object(s.c)((function(e){return e.network})).usersOnline,j=Object(s.b)(),m=Object(c.useState)((function(){return null===u||void 0===u?void 0:u.followings.includes(null===t||void 0===t?void 0:t._id)})),p=Object(O.a)(m,2),h=p[0],g=p[1],N=Object(s.c)((function(e){return e.network})).socket;Object(c.useEffect)((function(){var e=!0;if(N){var t=function(t){var n=t.userDisconnectId,c=t.time;e&&i((function(e){return e.map((function(e){return(null===e||void 0===e?void 0:e._id)===n?Object(b.a)(Object(b.a)({},e),{},{lastLogin:c}):e}))}))};return N.on("friendLogout",t),function(){e=!1,null===N||void 0===N||N.off("friendLogout",t)}}}),[N]),Object(c.useEffect)((function(){a.length&&i((function(e){return e.map((function(e){return null!==d&&void 0!==d&&d.includes(null===e||void 0===e?void 0:e._id)?Object(b.a)(Object(b.a)({},e),{},{online:!0}):Object(b.a)(Object(b.a)({},e),{},{online:!1})}))}))}),[d]),Object(c.useEffect)((function(){g(null===u||void 0===u?void 0:u.followings.includes(null===t||void 0===t?void 0:t._id))}),[null===u||void 0===u?void 0:u.followings,null===t||void 0===t?void 0:t._id]),Object(c.useEffect)((function(){var e=!0,n=function(){var n=Object(v.a)(Object(f.a)().mark((function n(){var c,r,a;return Object(f.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(t&&t._id||u&&u._id)){n.next=13;break}return n.prev=1,n.next=4,yt("/user/get-friends/".concat((null===t||void 0===t?void 0:t._id)||(null===u||void 0===u?void 0:u._id)));case 4:c=n.sent,c.message,r=c.friends,a=r.map((function(e){return null!==d&&void 0!==d&&d.includes(e._id)?Object(b.a)(Object(b.a)({},e),{},{online:!0}):Object(b.a)(Object(b.a)({},e),{},{online:!1})})),e&&i(a),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),console.log("err",n.t0);case 13:case"end":return n.stop()}}),n,null,[[1,10]])})));return function(){return n.apply(this,arguments)}}();return n(),function(){return e=!1}}),[t,u]);var y=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var n,c;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===t||void 0===t||!t._id){e.next=21;break}if(e.prev=1,!h){e.next=9;break}return e.next=5,Ct("/user/unfollow/".concat(t._id),{userId:u._id});case 5:n=e.sent,j({type:F,payload:t._id}),e.next=13;break;case 9:return e.next=11,Ct("/user/follow/".concat(t._id),{userId:u._id});case 11:n=e.sent,j({type:L,payload:t._id});case 13:c=n.message,l.b.success(c,{autoClose:2e3}),g(!h),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),console.log("err",e.t0);case 21:case"end":return e.stop()}}),e,null,[[1,18]])})));return function(){return e.apply(this,arguments)}}(),_=function(){return Object(et.jsxs)(et.Fragment,{children:[Object(et.jsxs)("div",{className:"birthdayContainer",children:[Object(et.jsx)("img",{className:"birthdayImg",src:x+"gift.png",alt:""}),Object(et.jsx)("span",{className:"birthdayText"})]}),Object(et.jsx)("img",{className:"rightbarAd",src:x+"social.png",alt:""}),Object(et.jsx)("h4",{className:"rightbarTitle",children:"Friends"}),Object(et.jsx)("ul",{className:"rightbarFriendList",children:a.map((function(e){return Object(et.jsx)(mc,{friend:e},null===e||void 0===e?void 0:e._id)}))})]})},C=function(){return Object(et.jsxs)(et.Fragment,{children:[(null===t||void 0===t?void 0:t.userName)!==(null===u||void 0===u?void 0:u.userName)&&Object(et.jsxs)("button",{className:"rightbarFollowButton",onClick:y,children:[h?"Unfollow":"Follow",h?Object(et.jsx)(vc.a,{}):Object(et.jsx)(Oc.a,{})]}),Object(et.jsx)("h4",{className:"rightbarTitle",children:"User information"}),Object(et.jsxs)("div",{className:"rightbarInfo",children:[Object(et.jsxs)("div",{className:"rightbarInfoItem",children:[Object(et.jsx)("span",{className:"rightbarInfoKey",children:"City:"}),Object(et.jsx)("span",{className:"rightbarInfoValue",children:null===t||void 0===t?void 0:t.city})]}),Object(et.jsxs)("div",{className:"rightbarInfoItem",children:[Object(et.jsx)("span",{className:"rightbarInfoKey",children:"From:"}),Object(et.jsx)("span",{className:"rightbarInfoValue",children:null===t||void 0===t?void 0:t.from})]}),Object(et.jsxs)("div",{className:"rightbarInfoItem",children:[Object(et.jsx)("span",{className:"rightbarInfoKey",children:"Relationship:"}),Object(et.jsx)("span",{className:"rightbarInfoValue",children:1===(null===t||void 0===t?void 0:t.relationships)?"Single":2===(null===t||void 0===t?void 0:t.relationships)?"Marry":"In a complicated relationship"})]})]}),Object(et.jsx)("h4",{className:"rightbarTitle",children:"User friends"}),Object(et.jsx)("div",{className:"rightbarFollowings",children:a.map((function(e){var t;return Object(et.jsxs)("div",{className:"rightbarFollowing",children:[Object(et.jsx)(o.b,{to:"/profile/".concat(null===e||void 0===e?void 0:e._id),children:Object(et.jsx)("img",{src:(null===e||void 0===e||null===(t=e.profilePicture)||void 0===t?void 0:t.length)&&(null===e||void 0===e?void 0:e.profilePicture[0])||x+"no-avatar.png",alt:"",className:"rightbarFollowingImg"})}),Object(et.jsx)("div",{className:"active ".concat(null!==e&&void 0!==e&&e.online?"online":"offline"," "),children:"8 hours"}),Object(et.jsx)("span",{className:"rightbarFollowingName",children:null===e||void 0===e?void 0:e.userName})]},e._id)}))})]})};return Object(et.jsx)("div",{className:"rightbar",children:t?Object(et.jsx)(C,{}):Object(et.jsx)(_,{})})}n(314);var hc=function(e){var t=e.children,n=Object(c.useState)(!1),r=Object(O.a)(n,2),a=r[0],i=r[1],o=Object(s.c)((function(e){return e.auth})).userCurrent,l=Object(d.m)(),u=Object(s.b)();return Object(c.useEffect)((function(){if(o)i(!0);else{var e=localStorage.getItem(m)?JSON.parse(localStorage.getItem(m)):"";if(!e)return l("/login");var t=Object(Ot.a)(e),n=t.exp,c=t.userId;if(n<(new Date).getTime()/1e3||!c)return l("/login");var r=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t,n;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,yt("/user?userId=".concat(c));case 3:t=e.sent,t.message,n=t.user,u({type:T,payload:n}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("err",e.t0),l("/login");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();r(),i(!0)}}),[]),a?Object(et.jsx)(et.Fragment,{children:t}):Object(et.jsx)(et.Fragment,{})},xc=(n(681),function(){var e=Object(d.o)().postId,t=Object(c.useState)(null),n=Object(O.a)(t,2),r=n[0],a=n[1];return Object(c.useEffect)((function(){var t=!0,n=function(){var n=Object(v.a)(Object(f.a)().mark((function n(){var c,r;return Object(f.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,yt("/post/".concat(e));case 3:c=n.sent,r=c.post,t&&a(r),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log("err",n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}();return n(),function(){return t=!1}}),[e]),Object(et.jsxs)(et.Fragment,{children:[Object(et.jsx)(Nn,{}),Object(et.jsxs)("div",{className:"homeContainer",children:[Object(et.jsx)(Xn,{}),Object(et.jsx)("div",{className:"postPageContainer",children:r&&Object(et.jsx)(oc,{post:r,className:"postPage"})}),Object(et.jsx)(pc,{})]})]})}),gc=[{path:"/*",component:Vn,layout:null,key:Object(N.a)()},{path:"/login",component:function(){var e=Object(c.useRef)(),t=Object(c.useRef)(),n=Object(d.m)(),r=Object(s.b)(),a=Object(s.c)((function(e){return e.auth})).isLoading;return Object(et.jsx)("div",{className:"login",children:Object(et.jsxs)("div",{className:"loginWrapper",children:[Object(et.jsxs)("div",{className:"loginLeft",children:[Object(et.jsx)("h3",{className:"loginLogo",children:"Coder Noob"}),Object(et.jsx)("span",{className:"loginDesc",children:"Connect with friends and the world around you on CODE NOOB."})]}),Object(et.jsx)("form",{className:"loginRight",onSubmit:function(c){c.preventDefault(),r(Tt({userName:e.current.value,password:t.current.value},n))},children:Object(et.jsxs)("div",{className:"loginBox",children:[Object(et.jsx)("input",{required:!0,placeholder:"User name",ref:e,type:"text",className:"loginInput"}),Object(et.jsx)("input",{required:!0,placeholder:"Password",ref:t,type:"password",className:"loginInput",minLength:"6"}),Object(et.jsx)("button",{className:"loginButton",children:a?Object(et.jsx)(Rt.a,{color:"primary",size:"30px"}):"Log In"}),Object(et.jsx)("span",{className:"loginForgot",children:"Forgot Password?"}),Object(et.jsx)("button",{className:"loginRegisterButton",onClick:function(){return n("/register")},children:a?Object(et.jsx)(Rt.a,{color:"primary",size:"30px"}):"Create a New Account"})]})})]})})},key:Object(N.a)(),layout:null},{path:"/register",component:Bn,key:Object(N.a)(),layout:null}],Nc=[{path:"/",component:function(){return Object(et.jsxs)("div",{className:"wrapper",children:[Object(et.jsx)(Nn,{}),Object(et.jsxs)("div",{className:"homeContainer",children:[Object(et.jsx)(Xn,{}),Object(et.jsx)(fc,{}),Object(et.jsx)(pc,{})]})]})},key:Object(N.a)(),layout:hc},{path:"/messenger",component:Bn,key:Object(N.a)(),layout:hc},{path:"/profile/:id",component:function(){var e,t,n=Object(d.o)().id,r=Object(s.c)((function(e){return e.auth})).userCurrent,a=Object(s.c)((function(e){return e.profile})).userProfile,i=Object(c.useRef)(Object(N.a)()),o=Object(c.useRef)(Object(N.a)()),l=Object(s.b)();Object(c.useEffect)((function(){var e=!0;if(r)if((null===r||void 0===r?void 0:r._id)!==n){var t=function(){var e=Object(v.a)(Object(f.a)().mark((function e(){var t,c;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,yt("/user?userId=".concat(n));case 3:t=e.sent,c=t.user,l({type:We,payload:{userProfile:c,isFriend:null===c||void 0===c?void 0:c.friends.includes(null===r||void 0===r?void 0:r._id)}}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("err",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();t()}else e&&l({type:Ze,payload:r});return function(){return e=!1}}),[r,n]);var u=function(){var e=Object(v.a)(Object(f.a)().mark((function e(t,n){var c,r,i,s,o;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length){e.next=2;break}return e.abrupt("return");case 2:return null!==(c=a[n])&&void 0!==c&&c.length&&st([a[n][1]]),e.next=5,it(t);case 5:for(o in i=e.sent,s=[],i[0])s.push(i[0][o]);return e.next=10,kt("/user/update-user",(r={},Object(Lt.a)(r,n,s),Object(Lt.a)(r,"userId",null===a||void 0===a?void 0:a._id),r));case 10:e.sent,l({type:"coverPicture"===n?P:D,payload:s});case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(et.jsxs)(et.Fragment,{children:[Object(et.jsx)(Nn,{}),Object(et.jsxs)("div",{className:"profile-container",children:[Object(et.jsxs)("div",{className:"profile-bgc",style:{backgroundImage:"url(".concat((null===a||void 0===a||null===(e=a.coverPicture)||void 0===e?void 0:e.length)&&(null===a||void 0===a?void 0:a.coverPicture[0])||x+"no-backgound.jpg",")")},children:[Object(et.jsx)("i",{className:"fa fa-bars","aria-hidden":"true"}),(null===a||void 0===a?void 0:a._id)===(null===r||void 0===r?void 0:r._id)&&Object(et.jsx)(yn,{id:i.current,text:"".concat(null!==a&&void 0!==a&&null!==(t=a.coverPicture)&&void 0!==t&&t.length&&null!==a&&void 0!==a&&a.coverPicture[0]?"Change":"Add"," cover photo"),type:"background"})]}),Object(et.jsx)("hr",{className:"separator separator--line"}),Object(et.jsx)("main",{children:Object(et.jsxs)("div",{className:"row",children:[Object(et.jsx)(Cn,{idAvatar:o}),Object(et.jsx)(Dn,{})]})})]}),Object(et.jsx)(qt,{onSave:u,width:"100%",multiple:!1,height:"300px",id:i.current,text:"Select the background image you want to update",typeImage:"coverPicture"}),Object(et.jsx)(qt,{onSave:u,multiple:!1,width:"100%",height:"250px",id:o.current,text:"Select the avatar image you want to update",typeImage:"profilePicture"})]})},key:Object(N.a)(),layout:hc},{path:"/post/:postId",component:xc,layout:hc,key:Object(N.a)()}];var yc=function(){var e=Object(s.c)((function(e){return e.network})),t=(e.firstConnect,e.socket),n=e.firstGetData,r=e.usersOnline,a=Object(s.c)((function(e){return e.auth})).userCurrent,i=Object(s.c)((function(e){return e.call})).isCall,o=Object(s.b)();return Object(c.useEffect)((function(){var e=function(e){o({type:ye,payload:{elClick:e.target}})};return window.addEventListener("click",e),function(){return window.removeEventListener("click",e)}}),[]),Object(c.useEffect)((function(){if(t){var e=function(e){var t=e.isVideo,n=e.userSendCall,c=e.roomCallId,r=e.isCreate,a=e.conversationId;o({type:B,payload:{isCall:!0,isVideo:t,userSendCall:n,roomCallId:c,isCreate:r,isSenderCall:!1,conversationId:a}})};return t.on("connectCall",e),function(){null===t||void 0===t||t.off("handleConnectCall",e)}}}),[t]),Object(c.useEffect)((function(){var e=new u.a(void 0,{host:"/",port:9e3});o({type:He,payload:e})}),[o]),Object(c.useEffect)((function(){var e=function(e){r.includes(e)||o({type:Ee,payload:e})},n=function(e){var t=e.userDisconnectId;o({type:Ae,payload:t})};return t&&(t.on("friendOnline",e),t.on("friendLogout",n)),function(){null===t||void 0===t||t.off("friendOnline",e),null===t||void 0===t||t.off("friendLogout",n)}}),[t]),Object(c.useEffect)((function(){var e=function(e){o({type:U,payload:e})},n=function(e){o({type:M,payload:e})};return t&&(t.on("addListFriend",e),t.on("removeListFriend",n)),function(){null===t||void 0===t||t.off("addListFriend",e),null===t||void 0===t||t.off("removeListFriend",n)}}),[t]),Object(c.useEffect)((function(){if(a){var e=function(e){if(n){var t=null===a||void 0===a?void 0:a.followings.filter((function(t){return e.find((function(e){return e===t}))}));o({type:we,payload:t})}},t=Object(j.a)(g);return t.emit("userLogin",{userId:null===a||void 0===a?void 0:a._id,friends:null===a||void 0===a?void 0:a.friends,userName:null===a||void 0===a?void 0:a.userName}),t.on("getUsers",e),o({type:Ie,payload:t}),function(){null===t||void 0===t||t.off("getUsers",e)}}}),[a]),Object(et.jsxs)(et.Fragment,{children:[Object(et.jsxs)(d.c,{children:[gc.map((function(e){var t=e.layout?e.layout:c.Fragment,n=e.component;return Object(et.jsx)(d.a,{path:e.path,element:Object(et.jsx)(t,{children:Object(et.jsx)(n,{})})},e.key)})),Nc.map((function(e){var t=e.layout?e.layout:c.Fragment,n=e.component;return Object(et.jsx)(d.a,{path:e.path,element:Object(et.jsx)(t,{children:Object(et.jsx)(n,{})})},e.key)}))]}),i&&Object(et.jsx)(St,{})]})},_c=n(129),Cc=n(327),kc={userCurrent:null,isLoading:!1,error:null},Ic=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case q:return Object(b.a)({},kc);case S:return Object(b.a)(Object(b.a)({},e),{},{isLoading:!0});case R:return Object(b.a)(Object(b.a)({},e),{},{isLoading:!1});case E:return Object(b.a)(Object(b.a)({},e),{},{userCurrent:c,isLoading:!1});case A:return Object(b.a)(Object(b.a)({},e),{},{isLoading:!1,userCurrent:null,error:c});case T:return Object(b.a)(Object(b.a)({},e),{},{userCurrent:c});case F:return Object(b.a)(Object(b.a)({},e),{},{userCurrent:Object(b.a)(Object(b.a)({},e.userCurrent),{},{followings:e.userCurrent.followings.filter((function(e){return e!==c}))})});case L:return Object(b.a)(Object(b.a)({},e),{},{userCurrent:Object(b.a)(Object(b.a)({},e.userCurrent),{},{followings:[c].concat(Object(bt.a)(e.userCurrent.followings))})});case D:return Object(b.a)(Object(b.a)({},e),{},{userCurrent:Object(b.a)(Object(b.a)({},e.userCurrent),{},{profilePicture:Object(bt.a)(c)})});case P:return Object(b.a)(Object(b.a)({},e),{},{userCurrent:Object(b.a)(Object(b.a)({},e.userCurrent),{},{coverPicture:Object(bt.a)(c)})});case U:return Object(b.a)(Object(b.a)({},e),{},{userCurrent:Object(b.a)(Object(b.a)({},e.userCurrent),{},{friends:[c].concat(Object(bt.a)(e.userCurrent.friends)),followings:[c].concat(Object(bt.a)(e.userCurrent.followings))})});case M:return Object(b.a)(Object(b.a)({},e),{},{userCurrent:Object(b.a)(Object(b.a)({},e.userCurrent),{},{friends:e.userCurrent.friends.filter((function(e){return e!==c}))})});default:return e}},wc={isVideo:null,isCall:null,userSendCall:null,userReciverCall:null,isSenderCall:!1,isAnswer:!1,friendInvites:[],fristLoadFriends:!0,isCreate:null,roomCallId:null,userStream:null,conversationId:null,isComplete:!1},Ec=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case q:return Object(b.a)({},wc);case Y:return Object(b.a)(Object(b.a)({},e),{},{isComplete:!0});case K:return Object(b.a)(Object(b.a)({},e),{},{userStream:c});case H:return Object(b.a)(Object(b.a)({},e),{},{isCreate:!1,isCall:!1,isVideo:null,userSendCall:null});case J:return Object(b.a)(Object(b.a)({},e),{},{isAnswer:!0,isCall:!0,isCreate:!1});case G:return Object(b.a)(Object(b.a)({},e),{},{friendInvites:c,fristLoadFriends:!1});case B:return Object(b.a)(Object(b.a)({},e),c);case V:var r=e.userStream;if(r)r.getTracks().forEach((function(e){return e.stop()}));return Object(b.a)({},wc);case Q:return Object(b.a)(Object(b.a)({},e),{},{isAnswer:c});default:return e}},Ac=n(14),Sc=["conversationId"],Rc={lastMessageConversation:null,isChat:!1,number:0,conversationChat:null,conversationUnReads:[],listConversation:[],isShowConversationPending:!1},Tc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Rc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case q:return Object(b.a)({},Rc);case ne:return Object(b.a)(Object(b.a)({},e),{},{isShowConversationPending:c});case W:var r=c.conversationId,a=Object(Ac.a)(c,Sc),i=e.listConversation;return Object(b.a)(Object(b.a)({},e),{},{listConversation:i.map((function(e){return e._id===r?Object(b.a)(Object(b.a)({},e),a):e}))});case Z:return Object(b.a)(Object(b.a)({},e),{},{lastMessageConversation:c});case z:var s=c.conversationId,o=c.isRead;return Object(b.a)(Object(b.a)({},e),{},{statusConversations:e.statusConversations.map((function(e){return e.conversationId===s?Object(b.a)(Object(b.a)({},e),{},{isRead:o}):e}))});case X:return Object(b.a)(Object(b.a)({},e),{},{statusConversations:c});case $:return Object(b.a)(Object(b.a)(Object(b.a)({},e),c),{},{number:0});case ee:var l=c.userId,u=c.conversations,d=[];return u.forEach((function(e){var t=e.reads,n=e.status,c=e._id;n.includes(l)&&(t.includes(l)||d.push(c))})),Object(b.a)(Object(b.a)({},e),{},{listConversation:u,conversationUnReads:d});case ae:var j=c.conversation,f=e.listConversation;return Object(b.a)(Object(b.a)({},e),{},{listConversation:tn(f,j,(function(e,t){return e.find((function(e){return e._id!==t._id}))}))});case le:var v=c.conversationId,O=c.userId;return Object(b.a)(Object(b.a)({},e),{},{conversationAccepts:e.conversationAccepts.map((function(e){return e._id===v?Object(b.a)(Object(b.a)({},e),{},{reads:[].concat(Object(bt.a)(e.reads),[O])}):e})),conversationDisplays:e.conversationDisplays.map((function(e){return e._id===v?Object(b.a)(Object(b.a)({},e),{},{reads:[].concat(Object(bt.a)(e.reads),[O])}):e}))});case ce:var m=e.conversationAccepts.find((function(e){return(null===e||void 0===e?void 0:e._id)===(null===c||void 0===c?void 0:c._id)}));if(m)return Object(b.a)({},e);var p=[c].concat(Object(bt.a)(e.conversationAccepts)),h=e.conversationPendings.filter((function(e){return(null===e||void 0===e?void 0:e._id)!==(null===c||void 0===c?void 0:c._id)}));return Object(b.a)(Object(b.a)({},e),{},{conversationAccepts:p,conversationDisplays:p,conversationPendings:h});case te:var x=c.conversationChat,g=c.isChangeType,N=e.isShowConversationPending,y=e.listConversation;return Object(b.a)(Object(b.a)({},e),{},{listConversation:y.map((function(e){return e._id===x._id?x:e})),conversationChat:x,isShowConversationPending:g?!N:N});case ue:var _=c.conversationChat;return Object(b.a)(Object(b.a)({},e),{},{conversationChat:_});case re:return Object(b.a)(Object(b.a)({},e),{},{friendChat:Object(b.a)(Object(b.a)({},e.friendChat),{},{lastLogin:c})});case ie:return Object(b.a)(Object(b.a)({},e),{},{number:c});case se:return Object(b.a)(Object(b.a)({},e),{},{conversationUnReads:tn(e.conversationUnReads,c)});case oe:return Object(b.a)(Object(b.a)({},e),{},{number:e.number-1});default:return e}},Fc={idComment:null,idPostOpen:null},Lc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case q:return Object(b.a)({},Fc);case de:return Object(b.a)(Object(b.a)({},e),c);default:return e}},Pc={isCreate:!1,friends:[],friendAdds:[]},Dc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case Oe:return Object(b.a)(Object(b.a)({},e),Pc);case ve:return Object(b.a)(Object(b.a)({},e),{},{friends:c});case je:return Object(b.a)(Object(b.a)({},e),{},{isCreate:c});case be:return Object(b.a)(Object(b.a)({},e),{},{friendAdds:tn(e.friendAdds,c,(function(e,t){return e.find((function(e){return(null===e||void 0===e?void 0:e._id)===(null===t||void 0===t?void 0:t._id)}))})),friends:e.friends.filter((function(e){return(null===e||void 0===e?void 0:e._id)!==(null===c||void 0===c?void 0:c._id)}))});case fe:return Object(b.a)(Object(b.a)({},e),{},{friends:tn(e.friends,c,(function(e,t){return e.find((function(e){return(null===e||void 0===e?void 0:e._id)===(null===t||void 0===t?void 0:t._id)}))})),friendAdds:e.friendAdds.filter((function(e){return(null===e||void 0===e?void 0:e._id)!==(null===c||void 0===c?void 0:c._id)}))});default:return e}},Uc={type:"received",listFriendRequest:null,number:0},Mc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Uc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case q:return Object(b.a)({},Uc);case me:return["received","sent"].includes(c)?Object(b.a)(Object(b.a)({},e),{},{type:c}):Object(b.a)({},e);case pe:return Object(b.a)(Object(b.a)({},e),{},{listFriendRequest:c,number:c.length});case he:return e.listFriendRequest.find((function(e){return(null===e||void 0===e?void 0:e._id)===(null===c||void 0===c?void 0:c._id)}))?Object(b.a)({},e):Object(b.a)(Object(b.a)({},e),{},{listFriendRequest:[c].concat(Object(bt.a)(e.listFriendRequest)),number:e.number+1});case xe:return Object(b.a)(Object(b.a)({},e),{},{listFriendRequest:e.listFriendRequest.filter((function(e){return(null===e||void 0===e?void 0:e._id)!==c})),number:e.number-1});case ge:return Object(b.a)(Object(b.a)({},e),{},{number:e.number+1});case Ne:return Object(b.a)(Object(b.a)({},e),{},{number:c});default:return e}},qc={elClick:null},Bc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;return n===ye?Object(b.a)(Object(b.a)({},e),c):e},Vc={files:[]},Qc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case q:return Object(b.a)({},Vc);case _e:return Object(b.a)(Object(b.a)({},e),{},{files:c});case Ce:return e.files.find((function(e){return(null===e||void 0===e?void 0:e.uuid)===(null===c||void 0===c?void 0:c.uuid)}))?Object(b.a)({},e):Object(b.a)(Object(b.a)({},e),{},{files:[c].concat(Object(bt.a)(e.files))});case ke:return Object(b.a)(Object(b.a)({},e),{},{files:e.files.filter((function(e){return(null===e||void 0===e?void 0:e.uuid)!==c}))});default:return e}},Gc={firstConnect:!0,socket:null,usersOnline:[],firstGetData:!0},Hc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case q:case Se:return Object(b.a)({},Gc);case Ie:return Object(b.a)(Object(b.a)({},e),{},{socket:c,firstConnect:!1});case we:return Object(b.a)(Object(b.a)({},e),{},{usersOnline:c||[],firstGetData:!1});case Ee:return Object(b.a)(Object(b.a)({},e),{},{usersOnline:tn(e.usersOnline,c)});case Ae:return Object(b.a)(Object(b.a)({},e),{},{usersOnline:e.usersOnline.filter((function(e){return e!==c}))});default:return e}},Jc={isShow:!1,isShowMenu:!1,number:0,listNotifycation:null,notificationDisplays:null,type:"all"},Kc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case q:return Object(b.a)({},Jc);case De:return Object(b.a)(Object(b.a)({},e),{},{isShow:c,number:0});case Re:return Object(b.a)(Object(b.a)({},e),{},{listNotifycation:c,notificationDisplays:c});case Fe:return Object(b.a)(Object(b.a)({},e),{},{number:c});case Le:return Object(b.a)(Object(b.a)({},e),{},{number:e.number+1});case Pe:return Object(b.a)(Object(b.a)({},e),{},{number:e.number-1});case Te:return Object(b.a)(Object(b.a)({},e),{},{listNotifycation:tn(e.listNotifycation,c,(function(e,t){return e.find((function(e){return(null===e||void 0===e?void 0:e._id)===(null===t||void 0===t?void 0:t._id)}))}))});case Qe:return Object(b.a)(Object(b.a)({},e),{},{notificationDisplays:tn(e.notificationDisplays,c,(function(e,t){return e.find((function(e){return(null===e||void 0===e?void 0:e._id)===(null===t||void 0===t?void 0:t._id)}))}))});case Ue:return Object(b.a)(Object(b.a)({},e),{},{listNotifycation:e.listNotifycation.filter((function(e){return(null===e||void 0===e?void 0:e._id)!==c})),notificationDisplays:e.notificationDisplays.filter((function(e){return(null===e||void 0===e?void 0:e._id)!==c}))});case qe:return Object(b.a)(Object(b.a)({},e),{},{notificationDisplays:c});case Me:return["all","read","unread"].includes(c)?Object(b.a)(Object(b.a)({},e),{},{type:c}):Object(b.a)({},e);case Be:return Object(b.a)(Object(b.a)({},e),{},{listNotifycation:[],notificationDisplays:[]});case Ve:return Object(b.a)(Object(b.a)({},e),{},{listNotifycation:e.listNotifycation.map((function(e){return(null===e||void 0===e?void 0:e._id)===(null===c||void 0===c?void 0:c._id)?c:e})),notificationDisplays:e.notificationDisplays.map((function(e){return(null===e||void 0===e?void 0:e._id)===(null===c||void 0===c?void 0:c._id)?c:e}))});case Ge:return Object(b.a)(Object(b.a)({},e),{},{isShowMenu:!e.isShowMenu});default:return e}},Yc=null,Wc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Yc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case He:return c;case q:return null;default:return e}},Zc={isLoadingPost:!0,limit:5,skip:0,isMaxPost:!1},zc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case q:return Object(b.a)({},Zc);case Je:return Object(b.a)(Object(b.a)({},e),c);case Ke:return Object(b.a)(Object(b.a)({},e),{},{isLoadingPost:!1});default:return e}},Xc={isFriend:null,userProfile:null,isMe:!1},$c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case q:return Object(b.a)({},Xc);case Ye:return Object(b.a)(Object(b.a)({},e),{},{isFriend:c});case We:var r=c.userProfile,a=c.isFriend;return Object(b.a)(Object(b.a)({},e),{},{userProfile:r,isFriend:a});case Ze:return Object(b.a)(Object(b.a)({},e),{},{isMe:!0,userProfile:c});default:return e}},er=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return{auth:Ic(e.auth,t),global:Bc(e.global,t),post:zc(e.post,t),comment:Lc(e.comment,t),chat:Tc(e.chat,t),friendRequest:Mc(e.friendRequest,t),message:Qc(e.message,t),network:Hc(e.network,t),notification:Kc(e.notification,t),profile:$c(e.profile,t),peer:Wc(e.peer,t),call:Ec(e.call,t),createRoomChat:Dc(e.createRoomChat,t)}},tr=n(326),nr=Object(tr.composeWithDevTools)(Object(_c.applyMiddleware)(Cc.a)),cr=Object(_c.createStore)(er,nr),rr=(n(696),function(e){return e.children});n(697);i.a.render(Object(et.jsx)(s.a,{store:cr,children:Object(et.jsxs)(r.a.StrictMode,{children:[Object(et.jsx)(o.a,{children:Object(et.jsx)(rr,{children:Object(et.jsx)(yc,{})})}),Object(et.jsx)(l.a,{})]})}),document.getElementById("root"))}},[[698,1,2]]]);
//# sourceMappingURL=main.23f7c1c5.chunk.js.map